<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cookbook &raquo; Conditional Tasking | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="Cookbook.html">Cookbook</a> &raquo;</span>
          Conditional Tasking
        </h1>
<p>Parallel workloads often require making control-flow decisions across dependent tasks. Taskflow supports an very efficient interface of conditional tasking for users to implement general control flow such as dynamic flow, cycles, and conditionals that are otherwise difficult to do with existing frameworks.</p><section id="CreateAConditionTask"><h2><a href="#CreateAConditionTask">Create a Condition Task</a></h2><p>A condition task evalutes a set of instructions and returns an integer index of the next successor task to execute. The index is defined with respect to the order of its successor construction. The following example creates an if-else block using a single condition task.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="p">,</span><span class="w"> </span><span class="n">yes</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w">  </span><span class="p">[]</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w">  </span><span class="p">[]</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w">  </span><span class="p">[]</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;yes</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w">  </span><span class="p">[]</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;no</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="n">cond</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">init</span><span class="p">)</span><span class="w"></span>
<span class="mi">11</span><span class="o">:</span><span class="w">     </span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">yes</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="p">);</span><span class="w">  </span><span class="c1">// executes yes if cond returns 0</span>
<span class="mi">12</span><span class="o">:</span><span class="w">                         </span><span class="c1">// executes no  if cond returns 1</span></pre><div class="m-graph"><svg style="width: 19.562rem; height: 6.250rem;" viewBox="0.00 0.00 312.97 99.77">
<g transform="scale(1 1) rotate(0) translate(4 95.7696)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7f9e1e700030</title>
<ellipse cx="28.9914" cy="-45.3848" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-41.5848">init</text>
</g>
<g id="node2" class="node"><title>p0x7f9e1e700140</title>
<polygon points="147.983,-71.3848 94.9828,-45.3848 147.983,-19.3848 200.983,-45.3848 147.983,-71.3848"/>
<text text-anchor="middle" x="147.983" y="-41.5848">cond</text>
</g>
<g id="edge1" class="edge"><title>p0x7f9e1e700030&#45;&gt;p0x7f9e1e700140</title>
<path fill="none" stroke="black" d="M58.0137,-45.3848C66.1552,-45.3848 75.3894,-45.3848 84.7517,-45.3848"/>
<polygon points="84.9155,-48.8849 94.9154,-45.3848 84.9154,-41.8849 84.9155,-48.8849"/>
</g>
<g id="node3" class="node"><title>p0x7f9e1e700250</title>
<ellipse cx="275.974" cy="-73.3848" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="275.974" y="-69.5848">yes</text>
</g>
<g id="edge2" class="edge"><title>p0x7f9e1e700140&#45;&gt;p0x7f9e1e700250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185.087,-53.4085C201.827,-57.1288 221.687,-61.5423 238.476,-65.2734"/>
<polygon points="237.956,-68.7432 248.477,-67.4961 239.475,-61.91 237.956,-68.7432"/>
<text text-anchor="middle" x="223.983" y="-67.5848">0</text>
</g>
<g id="node4" class="node"><title>p0x7f9e1e700360</title>
<ellipse cx="275.974" cy="-18.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="275.974" y="-14.5848">no</text>
</g>
<g id="edge3" class="edge"><title>p0x7f9e1e700140&#45;&gt;p0x7f9e1e700360</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185.425,-37.5753C202.517,-33.9123 222.802,-29.5653 239.74,-25.9355"/>
<polygon points="240.75,-29.2985 249.795,-23.7807 239.283,-22.4539 240.75,-29.2985"/>
<text text-anchor="middle" x="223.983" y="-35.5848">1</text>
</g>
</g>
</svg>
</div><p>Line 5 creates a condition task <code>cond</code> and line 11 creates two dependencies from <code>cond</code> to two other tasks, <code>yes</code> and <code>no</code>. With this order, when <code>cond</code> returns 0, the execution moves on to task <code>yes</code>. When <code>cond</code> returns 1, the execution moves on to task <code>no</code>.</p><aside class="m-note m-warning"><h4>Attention</h4><p>It is your responsibility to ensure the return of a condition task goes to a correct successor task. If the return falls beyond the range of the successors, the executor will not schedule any tasks.</p></aside><p>Condition task can go cyclic to describe <em>iterative</em> control flow. The example below implements a simple yet commonly used feedback loop through a condition task (line 7-10) that returns a random binary value. If the return value from <code>cond</code> is <code>0</code>, it loops back to itself, or otherwise to <code>stop</code>.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;stop&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"> </span><span class="c1">// creates a condition task that returns 0 or 1</span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">cond</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"></span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;flipping a coin</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">11</span><span class="o">:</span><span class="w"></span>
<span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="c1">// creates a feedback loop {0: cond, 1: stop}</span>
<span class="mi">13</span><span class="o">:</span><span class="w"> </span><span class="n">init</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span>
<span class="mi">14</span><span class="o">:</span><span class="w"> </span><span class="n">cond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="p">);</span><span class="w">  </span><span class="c1">// returns 0 to &#39;cond&#39; or 1 to &#39;stop&#39;</span>
<span class="mi">15</span><span class="o">:</span><span class="w"></span>
<span class="mi">16</span><span class="o">:</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 20.375rem; height: 6.000rem;" viewBox="0.00 0.00 325.69 96.00">
<g transform="scale(1 1) rotate(0) translate(4 92)">
<title>Taskflow</title>
<g id="node1" class="node"><title>cond</title>
<polygon points="147.983,-52 94.9828,-26 147.983,-0 200.983,-26 147.983,-52"/>
<text text-anchor="middle" x="147.983" y="-22.2">cond</text>
</g>
<g id="edge2" class="edge"><title>cond&#45;&gt;cond</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M135.678,-46.3672C132.944,-58.5417 137.045,-70 147.983,-70 155.759,-70 160.079,-64.2086 160.945,-56.4858"/>
<polygon points="164.429,-56.1191 160.287,-46.3672 157.443,-56.5732 164.429,-56.1191"/>
<text text-anchor="middle" x="147.983" y="-75.2">0</text>
</g>
<g id="node3" class="node"><title>stop</title>
<ellipse cx="282.338" cy="-26" rx="35.2113" ry="18.2703"/>
<text text-anchor="middle" x="282.338" y="-22.2">stop</text>
</g>
<g id="edge3" class="edge"><title>cond&#45;&gt;stop</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201.293,-26C213.021,-26 225.358,-26 236.739,-26"/>
<polygon points="236.876,-29.5001 246.876,-26 236.876,-22.5001 236.876,-29.5001"/>
<text text-anchor="middle" x="223.983" y="-31.2">1</text>
</g>
<g id="node2" class="node"><title>init</title>
<ellipse cx="28.9914" cy="-26" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-22.2">init</text>
</g>
<g id="edge1" class="edge"><title>init&#45;&gt;cond</title>
<path fill="none" stroke="black" d="M58.0137,-26C66.1552,-26 75.3894,-26 84.7517,-26"/>
<polygon points="84.9155,-29.5001 94.9154,-26 84.9154,-22.5001 84.9155,-29.5001"/>
</g>
</g>
</svg>
</div><p>A taskflow of complex control flow often just takes a few lines of code to implement, and different control flow blocks may run in parallel. The code below creates another taskflow with three condition tasks.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;B&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;D&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;E&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;F&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;G&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;H&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;I&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;M&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">cond_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">cond_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_2&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">cond_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cond_3&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">);</span><span class="w"></span>
<span class="n">B</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">C</span><span class="p">);</span><span class="w"></span>
<span class="n">C</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="n">D</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_1</span><span class="p">);</span><span class="w"></span>
<span class="n">E</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">K</span><span class="p">);</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_2</span><span class="p">);</span><span class="w"></span>
<span class="n">H</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">I</span><span class="p">);</span><span class="w"></span>
<span class="n">I</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_3</span><span class="p">);</span><span class="w"></span>
<span class="n">L</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">M</span><span class="p">);</span><span class="w"></span>

<span class="n">cond_1</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">);</span><span class="w">       </span><span class="c1">// return 0 to &#39;B&#39; or 1 to &#39;E&#39;</span>
<span class="n">cond_2</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">H</span><span class="p">);</span><span class="w">       </span><span class="c1">// return 0 to &#39;G&#39; or 1 to &#39;H&#39;</span>
<span class="n">cond_3</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond_3</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">);</span><span class="w">  </span><span class="c1">// return 0 to &#39;cond_3&#39; or 1 to &#39;L&#39;</span>

<span class="n">taskflow</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span><span class="w"></span></pre><p>The above code creates three condition tasks: (1) a condition task <code>cond_1</code> that loops back to <code>B</code> on returning <code>0</code>, or proceeds to <code>E</code> on returning <code>1</code>, (2) a condition task <code>cond_2</code> that goes to <code>G</code> on returning <code>0</code>, or <code>H</code> on returning <code>1</code>, (3) a condition task <code>cond_3</code> that loops back to itself on returning <code>0</code>, or proceeds to <code>L</code> on returning <code>1</code></p><div class="m-graph"><svg style="width: 61.875rem; height: 12.688rem;" viewBox="0.00 0.00 990.00 203.38">
<g transform="scale(1 1) rotate(0) translate(4 199.385)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7fecbdc02830</title>
<ellipse cx="27" cy="-108" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="27" y="-104.2">A</text>
</g>
<g id="node2" class="node"><title>p0x7fecbdc02940</title>
<ellipse cx="118" cy="-132" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="118" y="-128.2">B</text>
</g>
<g id="edge1" class="edge"><title>p0x7fecbdc02830&#45;&gt;p0x7fecbdc02940</title>
<path fill="none" stroke="black" d="M52.3196,-114.558C61.7382,-117.098 72.6868,-120.05 82.8687,-122.796"/>
<polygon points="82.1434,-126.225 92.7098,-125.45 83.9659,-119.467 82.1434,-126.225"/>
</g>
<g id="node3" class="node"><title>p0x7fecbdc02d80</title>
<ellipse cx="118" cy="-77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="118" y="-73.2">F</text>
</g>
<g id="edge2" class="edge"><title>p0x7fecbdc02830&#45;&gt;p0x7fecbdc02d80</title>
<path fill="none" stroke="black" d="M51.3837,-99.8551C61.3204,-96.394 73.0858,-92.2959 83.8907,-88.5325"/>
<polygon points="85.1712,-91.7927 93.4635,-85.1981 82.8686,-85.1823 85.1712,-91.7927"/>
</g>
<g id="node4" class="node"><title>p0x7fecbdc02a50</title>
<ellipse cx="253" cy="-177" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="253" y="-173.2">C</text>
</g>
<g id="edge3" class="edge"><title>p0x7fecbdc02940&#45;&gt;p0x7fecbdc02a50</title>
<path fill="none" stroke="black" d="M142.472,-139.942C163.613,-147.095 194.923,-157.688 218.659,-165.719"/>
<polygon points="217.721,-169.097 228.316,-168.987 219.965,-162.466 217.721,-169.097"/>
</g>
<g id="node9" class="node"><title>p0x7fecbdc03600</title>
<polygon points="253,-103 182,-77 253,-51 324,-77 253,-103"/>
<text text-anchor="middle" x="253" y="-73.2">cond_2</text>
</g>
<g id="edge7" class="edge"><title>p0x7fecbdc02d80&#45;&gt;p0x7fecbdc03600</title>
<path fill="none" stroke="black" d="M145.277,-77C153.199,-77 162.341,-77 171.874,-77"/>
<polygon points="171.914,-80.5001 181.914,-77 171.914,-73.5001 171.914,-80.5001"/>
</g>
<g id="node5" class="node"><title>p0x7fecbdc02b60</title>
<ellipse cx="397" cy="-177" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="397" y="-173.2">D</text>
</g>
<g id="edge4" class="edge"><title>p0x7fecbdc02a50&#45;&gt;p0x7fecbdc02b60</title>
<path fill="none" stroke="black" d="M280.045,-177C302.324,-177 334.634,-177 359.493,-177"/>
<polygon points="359.639,-180.5 369.639,-177 359.639,-173.5 359.639,-180.5"/>
</g>
<g id="node6" class="node"><title>p0x7fecbdc034f0</title>
<polygon points="532,-174 461,-148 532,-122 603,-148 532,-174"/>
<text text-anchor="middle" x="532" y="-144.2">cond_1</text>
</g>
<g id="edge5" class="edge"><title>p0x7fecbdc02b60&#45;&gt;p0x7fecbdc034f0</title>
<path fill="none" stroke="black" d="M423.016,-171.545C438.261,-168.221 458.348,-163.841 477.058,-159.762"/>
<polygon points="477.952,-163.149 486.977,-157.599 476.461,-156.31 477.952,-163.149"/>
</g>
<g id="edge11" class="edge"><title>p0x7fecbdc034f0&#45;&gt;p0x7fecbdc02940</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467.526,-145.535C380.013,-142.136 225.191,-136.124 155.176,-133.405"/>
<polygon points="155.213,-129.904 145.085,-133.013 154.942,-136.899 155.213,-129.904"/>
<text text-anchor="middle" x="347" y="-146.2">0</text>
</g>
<g id="node7" class="node"><title>p0x7fecbdc02c70</title>
<ellipse cx="720" cy="-148" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="720" y="-144.2">E</text>
</g>
<g id="edge12" class="edge"><title>p0x7fecbdc034f0&#45;&gt;p0x7fecbdc02c70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M603.054,-148C630.079,-148 659.862,-148 682.476,-148"/>
<polygon points="682.641,-151.5 692.641,-148 682.641,-144.5 682.641,-151.5"/>
<text text-anchor="middle" x="626" y="-153.2">1</text>
</g>
<g id="node8" class="node"><title>p0x7fecbdc031c0</title>
<ellipse cx="864" cy="-148" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="864" y="-144.2">K</text>
</g>
<g id="edge6" class="edge"><title>p0x7fecbdc02c70&#45;&gt;p0x7fecbdc031c0</title>
<path fill="none" stroke="black" d="M747.045,-148C769.324,-148 801.634,-148 826.493,-148"/>
<polygon points="826.639,-151.5 836.639,-148 826.639,-144.5 826.639,-151.5"/>
</g>
<g id="node10" class="node"><title>p0x7fecbdc02e90</title>
<ellipse cx="397" cy="-81" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="397" y="-77.2">G</text>
</g>
<g id="edge13" class="edge"><title>p0x7fecbdc03600&#45;&gt;p0x7fecbdc02e90</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319.182,-78.8361C333.054,-79.2269 347.224,-79.626 359.555,-79.9734"/>
<polygon points="359.77,-83.4807 369.865,-80.2638 359.967,-76.4835 359.77,-83.4807"/>
<text text-anchor="middle" x="347" y="-85.2">0</text>
</g>
<g id="node11" class="node"><title>p0x7fecbdc02fa0</title>
<ellipse cx="397" cy="-26" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="397" y="-22.2">H</text>
</g>
<g id="edge14" class="edge"><title>p0x7fecbdc03600&#45;&gt;p0x7fecbdc02fa0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M289.466,-64.2621C311.977,-56.1772 340.909,-45.7862 362.94,-37.8736"/>
<polygon points="364.301,-41.1039 372.529,-34.4297 361.935,-34.5159 364.301,-41.1039"/>
<text text-anchor="middle" x="347" y="-49.2">1</text>
</g>
<g id="node12" class="node"><title>p0x7fecbdc030b0</title>
<ellipse cx="532" cy="-26" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="532" y="-22.2">I</text>
</g>
<g id="edge8" class="edge"><title>p0x7fecbdc02fa0&#45;&gt;p0x7fecbdc030b0</title>
<path fill="none" stroke="black" d="M424.277,-26C444.405,-26 472.41,-26 494.682,-26"/>
<polygon points="494.778,-29.5001 504.778,-26 494.778,-22.5001 494.778,-29.5001"/>
</g>
<g id="node13" class="node"><title>p0x7fecbdc03710</title>
<polygon points="720,-52 649,-26 720,3.55271e-15 791,-26 720,-52"/>
<text text-anchor="middle" x="720" y="-22.2">cond_3</text>
</g>
<g id="edge9" class="edge"><title>p0x7fecbdc030b0&#45;&gt;p0x7fecbdc03710</title>
<path fill="none" stroke="black" d="M559.255,-26C580.037,-26 610.217,-26 638.762,-26"/>
<polygon points="638.773,-29.5001 648.773,-26 638.772,-22.5001 638.773,-29.5001"/>
</g>
<g id="edge15" class="edge"><title>p0x7fecbdc03710&#45;&gt;p0x7fecbdc03710</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M703.477,-46.3672C699.805,-58.5417 705.312,-70 720,-70 730.442,-70 736.244,-64.2086 737.407,-56.4858"/>
<polygon points="740.88,-56.025 736.523,-46.3672 733.906,-56.6337 740.88,-56.025"/>
<text text-anchor="middle" x="720" y="-75.2">0</text>
</g>
<g id="node14" class="node"><title>p0x7fecbdc032d0</title>
<ellipse cx="864" cy="-26" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="864" y="-22.2">L</text>
</g>
<g id="edge16" class="edge"><title>p0x7fecbdc03710&#45;&gt;p0x7fecbdc032d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M791.168,-26C803.431,-26 815.727,-26 826.592,-26"/>
<polygon points="826.927,-29.5001 836.927,-26 826.927,-22.5001 826.927,-29.5001"/>
<text text-anchor="middle" x="814" y="-31.2">1</text>
</g>
<g id="node15" class="node"><title>p0x7fecbdc033e0</title>
<ellipse cx="955" cy="-26" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="955" y="-22.2">M</text>
</g>
<g id="edge10" class="edge"><title>p0x7fecbdc032d0&#45;&gt;p0x7fecbdc033e0</title>
<path fill="none" stroke="black" d="M891.222,-26C899.551,-26 908.914,-26 917.816,-26"/>
<polygon points="917.966,-29.5001 927.966,-26 917.966,-22.5001 917.966,-29.5001"/>
</g>
</g>
</svg>
</div><p>You can use condition tasks to create cycles as long as the graph does not introduce task race during execution. However, cycles are not allowed in non-condition tasks.</p><aside class="m-note m-info"><h4>Note</h4><p>Conditional tasking lets you make in-task control-flow decisions to enable <em>end-to-end</em> parallelism, instead of resorting to client-side partition or synchronizing your task graph at the decision points of control flow.</p></aside></section><section id="TaskSchedulingPolicy"><h2><a href="#TaskSchedulingPolicy">Understand our Task-level Scheduling</a></h2><p>In order to understand how an executor schedules condition tasks, we define two dependency types, <em>strong dependency</em> and <em>weak dependency</em>. A strong dependency is a preceding link from a non-condition task to another task. A weak dependency is a preceding link from a condition task to another task. The number of dependents of a task is the sum of strong dependency and weak dependency. The table below lists the strong dependency and weak dependency numbers of each task in the previous example.</p><table class="m-table"><thead><tr><th>task</th><th>strong dependency</th><th>weak dependency</th><th>dependents</th></tr></thead><tbody><tr><td>A</td><td>0</td><td>0</td><td>0</td></tr><tr><td>B</td><td>1</td><td>1</td><td>2</td></tr><tr><td>C</td><td>1</td><td>0</td><td>1</td></tr><tr><td>D</td><td>1</td><td>0</td><td>1</td></tr><tr><td>E</td><td>0</td><td>1</td><td>1</td></tr><tr><td>F</td><td>1</td><td>0</td><td>1</td></tr><tr><td>G</td><td>0</td><td>1</td><td>1</td></tr><tr><td>H</td><td>0</td><td>1</td><td>1</td></tr><tr><td>I</td><td>1</td><td>0</td><td>1</td></tr><tr><td>K</td><td>1</td><td>0</td><td>1</td></tr><tr><td>L</td><td>0</td><td>1</td><td>1</td></tr><tr><td>M</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_2</td><td>1</td><td>0</td><td>1</td></tr><tr><td>cond_3</td><td>1</td><td>1</td><td>2</td></tr></tbody></table><p>You can query the number of strong dependents, the number of weak dependents, and the number of dependents of a task.</p><pre class="m-code"><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="mi">2</span><span class="o">:</span><span class="w"> </span>
<span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){});</span><span class="w"></span>
<span class="mi">4</span><span class="o">:</span><span class="w"> </span>
<span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="c1">// ... add more tasks and preceding links</span>
<span class="mi">6</span><span class="o">:</span><span class="w"></span>
<span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="n">num_dependents</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span>
<span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="n">num_strong_dependents</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"> </span>
<span class="mi">9</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">task</span><span class="p">.</span><span class="n">num_weak_dependents</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"></span></pre><p>When you submit a task to an executor, the scheduler starts with tasks of <em>zero dependents</em> (both zero strong and weak dependencies) and continues to execute successive tasks whenever their <em>strong dependencies</em> are met. However, the scheduler skips this rule when executing a condition task and jumps directly to its successors indexed by the return value.</p><div class="m-graph"><svg style="width: 66.375rem; height: 23.250rem;" viewBox="0.00 0.00 1061.60 372.08">
<g transform="scale(1 1) rotate(0) translate(4 368.078)">
<title>G</title>
<g id="node1" class="node"><title>atask</title>
<ellipse cx="690.704" cy="-345.693" rx="52.1524" ry="18.2703"/>
<text text-anchor="middle" x="690.704" y="-341.893">a task T</text>
</g>
<g id="node2" class="node"><title>cond</title>
<polygon points="690.704,-290.309 518.704,-264.309 690.704,-238.309 862.704,-264.309 690.704,-290.309"/>
<text text-anchor="middle" x="690.704" y="-260.509">is T a condition task?</text>
</g>
<g id="edge1" class="edge"><title>atask&#45;&gt;cond</title>
<path fill="none" stroke="black" d="M690.704,-327.075C690.704,-319.243 690.704,-309.729 690.704,-300.538"/>
<polygon points="694.204,-300.406 690.704,-290.406 687.204,-300.406 694.204,-300.406"/>
</g>
<g id="node3" class="node"><title>invokeN</title>
<ellipse cx="479.704" cy="-165.924" rx="61.5366" ry="18.2703"/>
<text text-anchor="middle" x="479.704" y="-162.124">invoke(T)</text>
</g>
<g id="edge6" class="edge"><title>cond&#45;&gt;invokeN</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M649.52,-244.496C612.639,-227.649 558.8,-203.055 521.679,-186.098"/>
<polygon points="522.702,-182.718 512.152,-181.746 519.794,-189.085 522.702,-182.718"/>
<text text-anchor="middle" x="601.704" y="-207.509">no</text>
</g>
<g id="node4" class="node"><title>invokeY</title>
<ellipse cx="827.704" cy="-165.924" rx="80.7205" ry="18.2703"/>
<text text-anchor="middle" x="827.704" y="-162.124">R = invoke(T)</text>
</g>
<g id="edge5" class="edge"><title>cond&#45;&gt;invokeY</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M720.094,-242.632C742.264,-227.034 772.654,-205.654 795.485,-189.591"/>
<polygon points="797.667,-192.335 803.832,-183.719 793.639,-186.61 797.667,-192.335"/>
<text text-anchor="middle" x="788.204" y="-207.509">yes</text>
</g>
<g id="node6" class="node"><title>decrement</title>
<ellipse cx="338.704" cy="-92.1543" rx="338.908" ry="18.2703"/>
<text text-anchor="middle" x="338.704" y="-88.3543">decrement strong dependencies of each successor of T by one</text>
</g>
<g id="edge2" class="edge"><title>invokeN&#45;&gt;decrement</title>
<path fill="none" stroke="black" d="M449.802,-149.703C430.067,-139.658 403.894,-126.336 381.909,-115.146"/>
<polygon points="383.274,-111.913 372.775,-110.496 380.099,-118.152 383.274,-111.913"/>
</g>
<g id="node5" class="node"><title>enqueueR</title>
<ellipse cx="874.704" cy="-92.1543" rx="178.796" ry="18.2703"/>
<text text-anchor="middle" x="874.704" y="-88.3543">enqueue the R&#45;th successor of T</text>
</g>
<g id="edge4" class="edge"><title>invokeY&#45;&gt;enqueueR</title>
<path fill="none" stroke="black" d="M839.082,-147.55C844.64,-139.062 851.445,-128.671 857.612,-119.253"/>
<polygon points="860.718,-120.9 863.269,-110.616 854.862,-117.065 860.718,-120.9"/>
</g>
<g id="node7" class="node"><title>enqueueS</title>
<ellipse cx="338.704" cy="-18.3848" rx="263.087" ry="18.2703"/>
<text text-anchor="middle" x="338.704" y="-14.5848">enqueue successors of zero strong dpendencies</text>
</g>
<g id="edge3" class="edge"><title>decrement&#45;&gt;enqueueS</title>
<path fill="none" stroke="black" d="M338.704,-73.4135C338.704,-65.5046 338.704,-56 338.704,-47.1826"/>
<polygon points="342.204,-46.9215 338.704,-36.9215 335.204,-46.9215 342.204,-46.9215"/>
</g>
</g>
</svg>
</div><p>Each task has an <em>atomic</em> join counter to keep track of strong dependents that are met at runtime. When a task completes, the join counter is restored to the task&#x27;s strong dependency number in the graph, such that the subsequent execution can reuse the counter again.</p><section id="TaskLevelSchedulingExample"><h3><a href="#TaskLevelSchedulingExample">Example</a></h3><p>Let&#x27;s take a look at an example to understand how task-level scheduling works. Suppose we have the following taskflow of one condition task <code>cond</code> that forms a loop to itself on returning <code>0</code> and moves on to <code>stop</code> on returning <code>1</code>:</p><div class="m-graph"><svg style="width: 20.375rem; height: 6.000rem;" viewBox="0.00 0.00 325.69 96.00">
<g transform="scale(1 1) rotate(0) translate(4 92)">
<title>Taskflow</title>
<g id="node1" class="node"><title>cond</title>
<polygon points="147.983,-52 94.9828,-26 147.983,-0 200.983,-26 147.983,-52"/>
<text text-anchor="middle" x="147.983" y="-22.2">cond</text>
</g>
<g id="edge2" class="edge"><title>cond&#45;&gt;cond</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M135.678,-46.3672C132.944,-58.5417 137.045,-70 147.983,-70 155.759,-70 160.079,-64.2086 160.945,-56.4858"/>
<polygon points="164.429,-56.1191 160.287,-46.3672 157.443,-56.5732 164.429,-56.1191"/>
<text text-anchor="middle" x="147.983" y="-75.2">0</text>
</g>
<g id="node3" class="node"><title>stop</title>
<ellipse cx="282.338" cy="-26" rx="35.2113" ry="18.2703"/>
<text text-anchor="middle" x="282.338" y="-22.2">stop</text>
</g>
<g id="edge3" class="edge"><title>cond&#45;&gt;stop</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201.293,-26C213.021,-26 225.358,-26 236.739,-26"/>
<polygon points="236.876,-29.5001 246.876,-26 236.876,-22.5001 236.876,-29.5001"/>
<text text-anchor="middle" x="223.983" y="-31.2">1</text>
</g>
<g id="node2" class="node"><title>init</title>
<ellipse cx="28.9914" cy="-26" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-22.2">init</text>
</g>
<g id="edge1" class="edge"><title>init&#45;&gt;cond</title>
<path fill="none" stroke="black" d="M58.0137,-26C66.1552,-26 75.3894,-26 84.7517,-26"/>
<polygon points="84.9155,-29.5001 94.9154,-26 84.9154,-22.5001 84.9155,-29.5001"/>
</g>
</g>
</svg>
</div><p>The scheduler starts with <code>init</code> task because it has no dependencies (both strong and weak dependencies). Then, the scheduler moves on to the condition task <code>cond</code>. If <code>cond</code> returns <code>0</code>, the scheduler enqueues <code>cond</code> and runs it again. If <code>cond</code> returns <code>1</code>, the scheduler enqueues <code>stop</code> and then moves on.</p></section></section><section id="AvoidCommonPitfalls"><h2><a href="#AvoidCommonPitfalls">Avoid Common Pitfalls</a></h2><p>Condition tasks are handy in creasing dynamic and cyclic control flows, but they are also easy to make mistakes. It is your responsibility to ensure a taskflow is properly conditioned. Top things to avoid include <em>no source tasks</em> to start with and <em>task race</em>. The figure below shows common pitfalls and their remedies.</p><div class="m-graph"><svg style="width: 62.188rem; height: 19.688rem;" viewBox="0.00 0.00 995.00 314.77">
<g transform="scale(1 1) rotate(0) translate(4 310.77)">
<title>Taskflow</title>
<g id="clust1" class="cluster"><title>cluster_error1</title>
<polygon points="8,-106.385 8,-298.77 193,-298.77 193,-106.385 8,-106.385"/>
<text text-anchor="middle" x="100.5" y="-281.97">error1: no source tasks</text>
</g>
<g id="clust2" class="cluster"><title>cluster_fix1</title>
<polygon points="201,-8 201,-291.154 355,-291.154 355,-8 201,-8"/>
<text text-anchor="middle" x="278" y="-274.354">fix1: adds a source</text>
</g>
<g id="clust3" class="cluster"><title>cluster_error2</title>
<polygon points="363,-106.385 363,-298.77 505,-298.77 505,-106.385 363,-106.385"/>
<text text-anchor="middle" x="434" y="-281.97">error2: race on D</text>
</g>
<g id="clust4" class="cluster"><title>cluster_fix2</title>
<polygon points="513,-8 513,-298.77 757,-298.77 757,-8 513,-8"/>
<text text-anchor="middle" x="635" y="-281.97">fix2: adds an auxiliary task</text>
</g>
<g id="clust5" class="cluster"><title>cluster_risky</title>
<polygon points="765,-106.385 765,-298.77 979,-298.77 979,-106.385 765,-106.385"/>
<text text-anchor="middle" x="872" y="-281.97">risky: X might be raced</text>
</g>
<g id="node1" class="node"><title>e1A</title>
<polygon points="59,-264.77 32,-238.77 59,-212.77 86,-238.77 59,-264.77"/>
<text text-anchor="middle" x="59" y="-234.97">A</text>
</g>
<g id="edge1" class="edge"><title>e1A&#45;&gt;e1A</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77.4896,-247.47C90.7706,-250.302 104,-247.402 104,-238.77 104,-232.362 96.7127,-229.113 87.5255,-229.022"/>
<polygon points="87.0721,-225.55 77.4896,-230.069 87.799,-232.512 87.0721,-225.55"/>
<text text-anchor="middle" x="109" y="-234.97">0</text>
</g>
<g id="node2" class="node"><title>e1B</title>
<ellipse cx="47" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="47" y="-128.97">B</text>
</g>
<g id="edge2" class="edge"><title>e1A&#45;&gt;e1B</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M56.3962,-215.203C54.5754,-199.423 52.1325,-178.251 50.194,-161.451"/>
<polygon points="53.6278,-160.675 49.0045,-151.142 46.6739,-161.477 53.6278,-160.675"/>
<text text-anchor="middle" x="59" y="-181.97">1</text>
</g>
<g id="node3" class="node"><title>e1C</title>
<ellipse cx="119" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="119" y="-128.97">C</text>
</g>
<g id="edge3" class="edge"><title>e1A&#45;&gt;e1C</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M68.375,-221.52C78.0052,-204.827 93.1312,-178.609 104.344,-159.173"/>
<polygon points="107.527,-160.66 109.493,-150.249 101.464,-157.161 107.527,-160.66"/>
<text text-anchor="middle" x="100" y="-181.97">2</text>
</g>
<g id="node4" class="node"><title>f1S</title>
<ellipse cx="252" cy="-238.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="252" y="-234.97">S</text>
</g>
<g id="node5" class="node"><title>f1A</title>
<polygon points="252,-158.77 225,-132.77 252,-106.77 279,-132.77 252,-158.77"/>
<text text-anchor="middle" x="252" y="-128.97">A</text>
</g>
<g id="edge4" class="edge"><title>f1S&#45;&gt;f1A</title>
<path fill="none" stroke="black" d="M252,-220.127C252,-206.21 252,-186.349 252,-169.182"/>
<polygon points="255.5,-168.918 252,-158.918 248.5,-168.918 255.5,-168.918"/>
</g>
<g id="edge5" class="edge"><title>f1A&#45;&gt;f1A</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M270.49,-141.47C283.771,-144.302 297,-141.402 297,-132.77 297,-126.362 289.713,-123.113 280.526,-123.022"/>
<polygon points="280.072,-119.55 270.49,-124.069 280.799,-126.512 280.072,-119.55"/>
<text text-anchor="middle" x="302" y="-128.97">0</text>
</g>
<g id="node6" class="node"><title>f1B</title>
<ellipse cx="240" cy="-34.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="240" y="-30.5848">B</text>
</g>
<g id="edge6" class="edge"><title>f1A&#45;&gt;f1B</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M249.217,-109.415C247.49,-95.5422 245.258,-77.6145 243.423,-62.876"/>
<polygon points="246.878,-62.3024 242.17,-52.8114 239.932,-63.1672 246.878,-62.3024"/>
<text text-anchor="middle" x="252" y="-75.9696">1</text>
</g>
<g id="node7" class="node"><title>f1C</title>
<ellipse cx="312" cy="-34.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="312" y="-30.5848">C</text>
</g>
<g id="edge7" class="edge"><title>f1A&#45;&gt;f1C</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M261.908,-115.854C271.318,-100.737 285.609,-77.7791 296.522,-60.2488"/>
<polygon points="299.563,-61.9857 301.877,-51.6466 293.621,-58.2864 299.563,-61.9857"/>
<text text-anchor="middle" x="295" y="-75.9696">2</text>
</g>
<g id="node8" class="node"><title>e2C</title>
<polygon points="470,-264.77 443,-238.77 470,-212.77 497,-238.77 470,-264.77"/>
<text text-anchor="middle" x="470" y="-234.97">C</text>
</g>
<g id="node9" class="node"><title>e2D</title>
<ellipse cx="398" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="398" y="-128.97">D</text>
</g>
<g id="edge9" class="edge"><title>e2C&#45;&gt;e2D</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459.376,-222.424C447.654,-205.493 428.63,-178.013 414.866,-158.131"/>
<polygon points="417.711,-156.092 409.141,-149.863 411.956,-160.077 417.711,-156.092"/>
<text text-anchor="middle" x="444" y="-181.97">0</text>
</g>
<g id="node10" class="node"><title>e2F</title>
<ellipse cx="470" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="470" y="-128.97">F</text>
</g>
<g id="edge10" class="edge"><title>e2C&#45;&gt;e2F</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M470,-212.594C470,-197.159 470,-177.383 470,-161.5"/>
<polygon points="473.5,-161.228 470,-151.228 466.5,-161.228 473.5,-161.228"/>
<text text-anchor="middle" x="475" y="-181.97">1</text>
</g>
<g id="node11" class="node"><title>e2E</title>
<ellipse cx="398" cy="-238.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="398" y="-234.97">E</text>
</g>
<g id="edge8" class="edge"><title>e2E&#45;&gt;e2D</title>
<path fill="none" stroke="black" d="M398,-220.127C398,-204.141 398,-180.312 398,-161.732"/>
<polygon points="401.5,-161.498 398,-151.498 394.5,-161.498 401.5,-161.498"/>
</g>
<g id="node12" class="node"><title>f2C</title>
<polygon points="664,-264.77 637,-238.77 664,-212.77 691,-238.77 664,-264.77"/>
<text text-anchor="middle" x="664" y="-234.97">C</text>
</g>
<g id="node14" class="node"><title>f2Daux</title>
<ellipse cx="635" cy="-132.77" rx="42.3529" ry="18.2703"/>
<text text-anchor="middle" x="635" y="-128.97">D&#45;aux</text>
</g>
<g id="edge12" class="edge"><title>f2C&#45;&gt;f2Daux</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M658.409,-217.717C653.923,-201.632 647.581,-178.887 642.629,-161.13"/>
<polygon points="645.956,-160.031 639.899,-151.338 639.214,-161.911 645.956,-160.031"/>
<text text-anchor="middle" x="657" y="-181.97">0</text>
</g>
<g id="node15" class="node"><title>f2F</title>
<ellipse cx="722" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="722" y="-128.97">F</text>
</g>
<g id="edge13" class="edge"><title>f2C&#45;&gt;f2F</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M673.319,-221.06C682.675,-204.283 697.207,-178.226 707.96,-158.945"/>
<polygon points="711.082,-160.533 712.896,-150.095 704.968,-157.123 711.082,-160.533"/>
<text text-anchor="middle" x="704" y="-181.97">1</text>
</g>
<g id="node13" class="node"><title>f2D</title>
<ellipse cx="571" cy="-34.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="571" y="-30.5848">D</text>
</g>
<g id="edge14" class="edge"><title>f2Daux&#45;&gt;f2D</title>
<path fill="none" stroke="black" d="M623.852,-114.981C613.727,-99.7321 598.669,-77.0541 587.213,-59.801"/>
<polygon points="590.043,-57.736 581.595,-51.3413 584.211,-61.6081 590.043,-57.736"/>
</g>
<g id="node16" class="node"><title>f2E</title>
<ellipse cx="548" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="548" y="-128.97">E</text>
</g>
<g id="edge11" class="edge"><title>f2E&#45;&gt;f2D</title>
<path fill="none" stroke="black" d="M552.112,-114.538C555.557,-100.099 560.537,-79.2301 564.519,-62.5453"/>
<polygon points="567.929,-63.3315 566.846,-52.7922 561.121,-61.7067 567.929,-63.3315"/>
</g>
<g id="node17" class="node"><title>rP</title>
<polygon points="897,-264.77 870,-238.77 897,-212.77 924,-238.77 897,-264.77"/>
<text text-anchor="middle" x="897" y="-234.97">P</text>
</g>
<g id="node19" class="node"><title>rQ</title>
<ellipse cx="944" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="944" y="-128.97">Q</text>
</g>
<g id="edge18" class="edge"><title>rP&#45;&gt;rQ</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M904.973,-220.127C912.467,-203.546 923.773,-178.527 932.29,-159.68"/>
<polygon points="935.526,-161.019 936.455,-150.465 929.147,-158.136 935.526,-161.019"/>
<text text-anchor="middle" x="929" y="-181.97">0</text>
</g>
<g id="node20" class="node"><title>rX</title>
<ellipse cx="872" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="872" y="-128.97">X</text>
</g>
<g id="edge15" class="edge"><title>rP&#45;&gt;rX</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M892.061,-217.222C888.219,-201.241 882.851,-178.911 878.635,-161.371"/>
<polygon points="881.923,-160.073 876.182,-151.168 875.117,-161.709 881.923,-160.073"/>
<text text-anchor="middle" x="891" y="-181.97">1</text>
</g>
<g id="node18" class="node"><title>rM</title>
<polygon points="816,-264.77 787,-238.77 816,-212.77 845,-238.77 816,-264.77"/>
<text text-anchor="middle" x="816" y="-234.97">M</text>
</g>
<g id="edge16" class="edge"><title>rM&#45;&gt;rX</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M825.247,-220.596C834.23,-203.914 847.978,-178.382 858.244,-159.317"/>
<polygon points="861.45,-160.745 863.109,-150.281 855.287,-157.426 861.45,-160.745"/>
<text text-anchor="middle" x="855" y="-181.97">0</text>
</g>
<g id="node21" class="node"><title>rN</title>
<ellipse cx="800" cy="-132.77" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="800" y="-128.97">N</text>
</g>
<g id="edge17" class="edge"><title>rM&#45;&gt;rN</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M812.607,-215.714C810.161,-199.814 806.843,-178.249 804.225,-161.232"/>
<polygon points="807.679,-160.668 802.699,-151.316 800.761,-161.732 807.679,-160.668"/>
<text text-anchor="middle" x="814" y="-181.97">1</text>
</g>
</g>
</svg>
</div><p>In the <code>error1</code> scenario, there is no source task for the scheduler to start with, and the simplest fix is to add a task <code>S</code> that has no dependents. In the <code>error2</code> scenario, <code>D</code> might be scheduled twice by <code>E</code> through the strong dependency and <code>C</code> through the weak dependency (on returning <code>1</code>). To fix this problem, you can add an auxiliary task <code>D-aux</code> to break the mixed use of strong dependency and weak dependency. In the risky scenario, task <code>X</code> may be raced by <code>M</code> and <code>P</code> if <code>M</code> returns <code>0</code> and P returns <code>1</code>.</p><aside class="m-note m-warning"><h4>Attention</h4><p>It is your responsibility to ensure a written taskflow graph is properly conditioned. We suggest that you <a href="ConditionalTasking.html#TaskSchedulingPolicy" class="m-doc">Understand our Task-level Scheduling</a> and infer if task race exists in the execution of your graph.</p></aside></section><section id="ImplementControlFlowGraphs"><h2><a href="#ImplementControlFlowGraphs">Implement Control-flow Graphs</a></h2><section id="ImplementIfElseControlFlow"><h3><a href="#ImplementIfElseControlFlow">Implement If-Else Control Flow</a></h3><p>You can use conditional tasking to implement if-else control flow. The following example creates a nested if-else control flow diagram that executes three condition tasks to check the range of <code>i</code>.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="c1">// create three condition tasks for nested control flow</span>
<span class="k">auto</span><span class="w"> </span><span class="n">initi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">cond1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">cond2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="mi">2</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">cond3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="mi">3</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">equl1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">equl2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=2</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">equl3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="k">auto</span><span class="w"> </span><span class="n">grtr3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i&gt;3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>

<span class="n">initi</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond1</span><span class="p">);</span><span class="w"></span>
<span class="n">cond1</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">equl1</span><span class="p">,</span><span class="w"> </span><span class="n">cond2</span><span class="p">);</span><span class="w">  </span><span class="c1">// goes to cond2 if i&gt;1</span>
<span class="n">cond2</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">equl2</span><span class="p">,</span><span class="w"> </span><span class="n">cond3</span><span class="p">);</span><span class="w">  </span><span class="c1">// goes to cond3 if i&gt;2</span>
<span class="n">cond3</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">equl3</span><span class="p">,</span><span class="w"> </span><span class="n">grtr3</span><span class="p">);</span><span class="w">  </span><span class="c1">// goes to grtr3 if i&gt;3</span></pre><div class="m-graph"><svg style="width: 74.250rem; height: 10.625rem;" viewBox="0.00 0.00 1188.42 169.77">
<g transform="scale(1 1) rotate(0) translate(4 165.77)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7fc231700030</title>
<ellipse cx="28.9914" cy="-117.385" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-113.585">init</text>
</g>
<g id="node2" class="node"><title>p0x7fc231700140</title>
<polygon points="238.983,-143.385 94.9828,-117.385 238.983,-91.3848 382.983,-117.385 238.983,-143.385"/>
<text text-anchor="middle" x="238.983" y="-113.585">cond1 (i&gt;1 ? 1 : 0)</text>
</g>
<g id="edge1" class="edge"><title>p0x7fc231700030&#45;&gt;p0x7fc231700140</title>
<path fill="none" stroke="black" d="M58.042,-117.385C65.8594,-117.385 74.9356,-117.385 84.7757,-117.385"/>
<polygon points="84.8522,-120.885 94.8522,-117.385 84.8522,-113.885 84.8522,-120.885"/>
</g>
<g id="node3" class="node"><title>p0x7fc231700470</title>
<ellipse cx="572.983" cy="-143.385" rx="41.9398" ry="18.2703"/>
<text text-anchor="middle" x="572.983" y="-139.585">equl1</text>
</g>
<g id="edge2" class="edge"><title>p0x7fc231700140&#45;&gt;p0x7fc231700470</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340.044,-125.221C399.988,-129.915 473.631,-135.682 521.631,-139.442"/>
<polygon points="521.525,-142.944 531.767,-140.235 522.071,-135.965 521.525,-142.944"/>
<text text-anchor="middle" x="405.983" y="-135.585">0</text>
</g>
<g id="node4" class="node"><title>p0x7fc231700250</title>
<polygon points="572.983,-107.385 428.983,-81.3848 572.983,-55.3848 716.983,-81.3848 572.983,-107.385"/>
<text text-anchor="middle" x="572.983" y="-77.5848">cond2 (i&gt;2 ? 1 : 0)</text>
</g>
<g id="edge3" class="edge"><title>p0x7fc231700140&#45;&gt;p0x7fc231700250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M329.389,-107.69C373.492,-102.908 426.833,-97.1239 472.254,-92.1987"/>
<polygon points="472.852,-95.6545 482.416,-91.0968 472.097,-88.6953 472.852,-95.6545"/>
<text text-anchor="middle" x="405.983" y="-104.585">1</text>
</g>
<g id="node5" class="node"><title>p0x7fc231700580</title>
<ellipse cx="906.983" cy="-107.385" rx="41.9398" ry="18.2703"/>
<text text-anchor="middle" x="906.983" y="-103.585">equl2</text>
</g>
<g id="edge4" class="edge"><title>p0x7fc231700250&#45;&gt;p0x7fc231700580</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M674.044,-89.2209C733.988,-93.9153 807.631,-99.6825 855.631,-103.442"/>
<polygon points="855.525,-106.944 865.767,-104.235 856.071,-99.9652 855.525,-106.944"/>
<text text-anchor="middle" x="739.983" y="-99.5848">0</text>
</g>
<g id="node6" class="node"><title>p0x7fc231700360</title>
<polygon points="906.983,-71.3848 762.983,-45.3848 906.983,-19.3848 1050.98,-45.3848 906.983,-71.3848"/>
<text text-anchor="middle" x="906.983" y="-41.5848">cond3 (i&gt;3 ? 1 : 0)</text>
</g>
<g id="edge5" class="edge"><title>p0x7fc231700250&#45;&gt;p0x7fc231700360</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M663.389,-71.6901C707.492,-66.9079 760.833,-61.1239 806.254,-56.1987"/>
<polygon points="806.852,-59.6545 816.416,-55.0968 806.097,-52.6953 806.852,-59.6545"/>
<text text-anchor="middle" x="739.983" y="-68.5848">1</text>
</g>
<g id="node7" class="node"><title>p0x7fc231700690</title>
<ellipse cx="1138.7" cy="-73.3848" rx="41.9398" ry="18.2703"/>
<text text-anchor="middle" x="1138.7" y="-69.5848">equl3</text>
</g>
<g id="edge6" class="edge"><title>p0x7fc231700360&#45;&gt;p0x7fc231700690</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M993.522,-55.8109C1025.42,-59.6989 1060.55,-63.981 1088.15,-67.3448"/>
<polygon points="1087.98,-70.8506 1098.33,-68.5863 1088.83,-63.902 1087.98,-70.8506"/>
<text text-anchor="middle" x="1073.98" y="-70.5848">0</text>
</g>
<g id="node8" class="node"><title>p0x7fc2317007a0</title>
<ellipse cx="1138.7" cy="-18.3848" rx="37.4533" ry="18.2703"/>
<text text-anchor="middle" x="1138.7" y="-14.5848">grtr3</text>
</g>
<g id="edge7" class="edge"><title>p0x7fc231700360&#45;&gt;p0x7fc2317007a0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M994.83,-35.1772C1027.84,-31.2974 1064.14,-27.0312 1091.89,-23.7697"/>
<polygon points="1092.56,-27.2153 1102.08,-22.5718 1091.74,-20.2631 1092.56,-27.2153"/>
<text text-anchor="middle" x="1073.98" y="-31.5848">1</text>
</g>
</g>
</svg>
</div></section><section id="ImplementSwitchControlFlow"><h3><a href="#ImplementSwitchControlFlow">Implement Switch Control Flow</a></h3><p>You can use conditional tasking to implement <em>switch</em> control flow. The following example creates a switch control flow diagram that executes one of the three cases at random using four condition tasks.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">swcond</span><span class="p">,</span><span class="w"> </span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;source</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;switch</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 2</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;target</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="n">source</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">swcond</span><span class="p">);</span><span class="w"></span>
<span class="n">swcond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">);</span><span class="w"></span>
<span class="n">target</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">);</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 35.812rem; height: 12.500rem;" viewBox="0.00 0.00 572.61 200.00">
<g transform="scale(1 1) rotate(0) translate(4 196)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7fa25f000030</title>
<ellipse cx="46.669" cy="-96" rx="46.8387" ry="18.2703"/>
<text text-anchor="middle" x="46.669" y="-92.2">source</text>
</g>
<g id="node2" class="node"><title>p0x7fa25f000140</title>
<polygon points="195.338,-122 130.338,-96 195.338,-70 260.338,-96 195.338,-122"/>
<text text-anchor="middle" x="195.338" y="-92.2">switch</text>
</g>
<g id="edge1" class="edge"><title>p0x7fa25f000030&#45;&gt;p0x7fa25f000140</title>
<path fill="none" stroke="black" d="M93.6736,-96C102.097,-96 111.082,-96 120.085,-96"/>
<polygon points="120.229,-99.5001 130.229,-96 120.229,-92.5001 120.229,-99.5001"/>
</g>
<g id="node3" class="node"><title>p0x7fa25f000250</title>
<polygon points="369.338,-192 306.338,-166 369.338,-140 432.338,-166 369.338,-192"/>
<text text-anchor="middle" x="369.338" y="-162.2">case 1</text>
</g>
<g id="edge2" class="edge"><title>p0x7fa25f000140&#45;&gt;p0x7fa25f000250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228.287,-109.002C256.251,-120.383 297.039,-136.983 327.392,-149.336"/>
<polygon points="326.269,-152.658 336.851,-153.185 328.908,-146.174 326.269,-152.658"/>
<text text-anchor="middle" x="283.338" y="-138.2">0</text>
</g>
<g id="node4" class="node"><title>p0x7fa25f000360</title>
<polygon points="369.338,-122 306.338,-96 369.338,-70 432.338,-96 369.338,-122"/>
<text text-anchor="middle" x="369.338" y="-92.2">case 2</text>
</g>
<g id="edge3" class="edge"><title>p0x7fa25f000140&#45;&gt;p0x7fa25f000360</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M260.385,-96C271.983,-96 284.151,-96 295.968,-96"/>
<polygon points="296.238,-99.5001 306.238,-96 296.238,-92.5001 296.238,-99.5001"/>
<text text-anchor="middle" x="283.338" y="-101.2">1</text>
</g>
<g id="node5" class="node"><title>p0x7fa25f000470</title>
<polygon points="369.338,-52 306.338,-26 369.338,-0 432.338,-26 369.338,-52"/>
<text text-anchor="middle" x="369.338" y="-22.2">case 3</text>
</g>
<g id="edge4" class="edge"><title>p0x7fa25f000140&#45;&gt;p0x7fa25f000470</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228.287,-82.9976C256.251,-71.6167 297.039,-55.0172 327.392,-42.6641"/>
<polygon points="328.908,-45.826 336.851,-38.8146 326.269,-39.3424 328.908,-45.826"/>
<text text-anchor="middle" x="283.338" y="-66.2">2</text>
</g>
<g id="node6" class="node"><title>p0x7fa25f000580</title>
<ellipse cx="521.472" cy="-96" rx="43.2674" ry="18.2703"/>
<text text-anchor="middle" x="521.472" y="-92.2">target</text>
</g>
<g id="edge5" class="edge"><title>p0x7fa25f000250&#45;&gt;p0x7fa25f000580</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M399.642,-152.337C423.354,-141.281 456.918,-125.632 482.656,-113.631"/>
<polygon points="484.168,-116.789 491.752,-109.391 481.21,-110.444 484.168,-116.789"/>
<text text-anchor="middle" x="455.338" y="-131.2">0</text>
</g>
<g id="edge6" class="edge"><title>p0x7fa25f000360&#45;&gt;p0x7fa25f000580</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M432.704,-96C444.424,-96 456.569,-96 467.951,-96"/>
<polygon points="468.156,-99.5001 478.156,-96 468.156,-92.5001 468.156,-99.5001"/>
<text text-anchor="middle" x="455.338" y="-101.2">0</text>
</g>
<g id="edge7" class="edge"><title>p0x7fa25f000470&#45;&gt;p0x7fa25f000580</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M399.642,-39.6629C423.354,-50.7189 456.918,-66.3682 482.656,-78.3686"/>
<polygon points="481.21,-81.5557 491.752,-82.6094 484.168,-75.2114 481.21,-81.5557"/>
<text text-anchor="middle" x="455.338" y="-72.2">0</text>
</g>
</g>
</svg>
</div><p>Assuming <code>swcond</code> returns 1, the program outputs:</p><pre class="m-code"><span class="n">source</span><span class="w"></span>
<span class="k">switch</span><span class="w"></span>
<span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="no">target</span><span class="w"></span></pre><p>Keep in mind, both switch and case tasks must be described as condition tasks. The following implementation is a common mistake in which case tasks are not described as condition tasks.</p><pre class="m-code"><span class="c1">// wrong implementation of switch control flow using only one condition task</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">swcond</span><span class="p">,</span><span class="w"> </span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;source</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;switch</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="o">%</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 2</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;case 3</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;target</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// target has three strong dependencies</span>
<span class="p">);</span><span class="w"></span>

<span class="n">source</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">swcond</span><span class="p">);</span><span class="w"></span>
<span class="n">swcond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">);</span><span class="w"></span>
<span class="n">target</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">case1</span><span class="p">,</span><span class="w"> </span><span class="n">case2</span><span class="p">,</span><span class="w"> </span><span class="n">case3</span><span class="p">);</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 32.938rem; height: 9.688rem;" viewBox="0.00 0.00 526.70 154.77">
<g transform="scale(1 1) rotate(0) translate(4 150.77)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7f96d3000030</title>
<ellipse cx="46.669" cy="-73.3848" rx="46.8387" ry="18.2703"/>
<text text-anchor="middle" x="46.669" y="-69.5848">source</text>
</g>
<g id="node2" class="node"><title>p0x7f96d3000140</title>
<polygon points="195.338,-99.3848 130.338,-73.3848 195.338,-47.3848 260.338,-73.3848 195.338,-99.3848"/>
<text text-anchor="middle" x="195.338" y="-69.5848">switch</text>
</g>
<g id="edge1" class="edge"><title>p0x7f96d3000030&#45;&gt;p0x7f96d3000140</title>
<path fill="none" stroke="black" d="M93.6736,-73.3848C102.097,-73.3848 111.082,-73.3848 120.085,-73.3848"/>
<polygon points="120.229,-76.8849 130.229,-73.3848 120.229,-69.8849 120.229,-76.8849"/>
</g>
<g id="node3" class="node"><title>p0x7f96d3000250</title>
<ellipse cx="350.886" cy="-128.385" rx="44.5955" ry="18.2703"/>
<text text-anchor="middle" x="350.886" y="-124.585">case 1</text>
</g>
<g id="edge2" class="edge"><title>p0x7f96d3000140&#45;&gt;p0x7f96d3000250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M230.415,-85.5911C253.012,-93.6852 282.846,-104.371 307.047,-113.04"/>
<polygon points="306.101,-116.419 316.695,-116.496 308.461,-109.829 306.101,-116.419"/>
<text text-anchor="middle" x="283.338" y="-110.585">0</text>
</g>
<g id="node4" class="node"><title>p0x7f96d3000360</title>
<ellipse cx="350.886" cy="-73.3848" rx="44.5955" ry="18.2703"/>
<text text-anchor="middle" x="350.886" y="-69.5848">case 2</text>
</g>
<g id="edge3" class="edge"><title>p0x7f96d3000140&#45;&gt;p0x7f96d3000360</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M260.566,-73.3848C272.269,-73.3848 284.372,-73.3848 295.747,-73.3848"/>
<polygon points="295.956,-76.8849 305.956,-73.3848 295.956,-69.8849 295.956,-76.8849"/>
<text text-anchor="middle" x="283.338" y="-78.5848">1</text>
</g>
<g id="node5" class="node"><title>p0x7f96d3000470</title>
<ellipse cx="350.886" cy="-18.3848" rx="44.5955" ry="18.2703"/>
<text text-anchor="middle" x="350.886" y="-14.5848">case 3</text>
</g>
<g id="edge4" class="edge"><title>p0x7f96d3000140&#45;&gt;p0x7f96d3000470</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M230.415,-61.1785C253.012,-53.0843 282.846,-42.3983 307.047,-33.7296"/>
<polygon points="308.461,-36.9407 316.695,-30.2734 306.101,-30.3507 308.461,-36.9407"/>
<text text-anchor="middle" x="283.338" y="-48.5848">2</text>
</g>
<g id="node6" class="node"><title>p0x7f96d3000580</title>
<ellipse cx="475.567" cy="-73.3848" rx="43.2674" ry="18.2703"/>
<text text-anchor="middle" x="475.567" y="-69.5848">target</text>
</g>
<g id="edge5" class="edge"><title>p0x7f96d3000250&#45;&gt;p0x7f96d3000580</title>
<path fill="none" stroke="black" d="M381.897,-114.93C398.177,-107.632 418.482,-98.5288 435.932,-90.7056"/>
<polygon points="437.596,-93.7953 445.289,-86.5106 434.732,-87.4078 437.596,-93.7953"/>
</g>
<g id="edge6" class="edge"><title>p0x7f96d3000360&#45;&gt;p0x7f96d3000580</title>
<path fill="none" stroke="black" d="M395.484,-73.3848C404.097,-73.3848 413.221,-73.3848 422.092,-73.3848"/>
<polygon points="422.344,-76.8849 432.344,-73.3848 422.344,-69.8849 422.344,-76.8849"/>
</g>
<g id="edge7" class="edge"><title>p0x7f96d3000470&#45;&gt;p0x7f96d3000580</title>
<path fill="none" stroke="black" d="M381.897,-31.8393C398.177,-39.1379 418.482,-48.2408 435.932,-56.064"/>
<polygon points="434.732,-59.3618 445.289,-60.259 437.596,-52.9743 434.732,-59.3618"/>
</g>
</g>
</svg>
</div><p>In this faulty implementation, task <code>target</code> has three strong dependencies but only one of them will be met. This is because <code>swcond</code> is a condition task, and only one case task will be executed depending on the return of <code>swcond</code>.</p></section><section id="ImplementDoWhileLoopControlFlow"><h3><a href="#ImplementDoWhileLoopControlFlow">Implement Do-While-Loop Control Flow</a></h3><p>You can use conditional tasking to implement <em>do-while-loop</em> control flow. The following example creates a do-while-loop control flow diagram that repeatedly increments variable <code>i</code> five times using one condition task.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i++ =&gt; i=&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">);</span><span class="w">  </span>

<span class="n">init</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">body</span><span class="p">);</span><span class="w"></span>
<span class="n">body</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span>
<span class="n">cond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">);</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 32.875rem; height: 3.750rem;" viewBox="0.00 0.00 526.45 60.00">
<g transform="scale(1 1) rotate(0) translate(4 56)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7f950d600030</title>
<ellipse cx="28.9914" cy="-26" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-22.2">init</text>
</g>
<g id="node2" class="node"><title>p0x7f950d600140</title>
<ellipse cx="138.823" cy="-26" rx="43.6818" ry="18.2703"/>
<text text-anchor="middle" x="138.823" y="-22.2">do i++</text>
</g>
<g id="edge1" class="edge"><title>p0x7f950d600030&#45;&gt;p0x7f950d600140</title>
<path fill="none" stroke="black" d="M58.0415,-26C66.2026,-26 75.3999,-26 84.5715,-26"/>
<polygon points="84.8592,-29.5001 94.8591,-26 84.8591,-22.5001 84.8592,-29.5001"/>
</g>
<g id="node3" class="node"><title>p0x7f950d600250</title>
<polygon points="311.664,-52 228.664,-26 311.664,-0 394.664,-26 311.664,-52"/>
<text text-anchor="middle" x="311.664" y="-22.2">while i&lt;5</text>
</g>
<g id="edge2" class="edge"><title>p0x7f950d600140&#45;&gt;p0x7f950d600250</title>
<path fill="none" stroke="black" d="M182.363,-28.365C188.502,-28.6285 194.744,-28.8541 200.664,-29 209.57,-29.2194 218.882,-29.2594 228.155,-29.178"/>
<polygon points="228.23,-32.6774 238.182,-29.0447 228.137,-25.678 228.23,-32.6774"/>
</g>
<g id="edge3" class="edge"><title>p0x7f950d600250&#45;&gt;p0x7f950d600140</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M270.497,-12.7719C249.688,-7.51579 223.846,-3.46447 200.664,-7 194.49,-7.94159 188.082,-9.39146 181.842,-11.0797"/>
<polygon points="180.848,-7.72355 172.233,-13.8902 182.813,-14.4421 180.848,-7.72355"/>
<text text-anchor="middle" x="205.664" y="-12.2">0</text>
</g>
<g id="node4" class="node"><title>p0x7f950d600360</title>
<ellipse cx="479.555" cy="-26" rx="38.7821" ry="18.2703"/>
<text text-anchor="middle" x="479.555" y="-22.2">done</text>
</g>
<g id="edge4" class="edge"><title>p0x7f950d600250&#45;&gt;p0x7f950d600360</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M395.123,-26C407.201,-26 419.293,-26 430.374,-26"/>
<polygon points="430.655,-29.5001 440.655,-26 430.655,-22.5001 430.655,-29.5001"/>
<text text-anchor="middle" x="417.664" y="-31.2">1</text>
</g>
</g>
</svg>
</div><p>The program outputs:</p><pre class="m-code"><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="w"></span>
<span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="w"></span>
<span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">5</span><span class="w"></span>
<span class="n">done</span><span class="w"></span></pre></section><section id="ImplementWhileLoopControlFlow"><h3><a href="#ImplementWhileLoopControlFlow">Implement While-Loop Control Flow</a></h3><p>You can use conditional tasking to implement <em>while-loop</em> control flow. The following example creates a while-loop control flow diagram that repeatedly increments variable <code>i</code> five times using two condition task.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">back</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;while i&lt;5</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i++=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;back</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="n">init</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span>
<span class="n">cond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">);</span><span class="w"></span>
<span class="n">body</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">back</span><span class="p">);</span><span class="w"></span>
<span class="n">back</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 33.500rem; height: 8.875rem;" viewBox="0.00 0.00 535.76 142.38">
<g transform="scale(1 1) rotate(0) translate(4 138.385)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7fdba4000030</title>
<ellipse cx="28.9914" cy="-61" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-57.2">init</text>
</g>
<g id="node2" class="node"><title>p0x7fdba4000140</title>
<polygon points="177.983,-87 94.9828,-61 177.983,-35 260.983,-61 177.983,-87"/>
<text text-anchor="middle" x="177.983" y="-57.2">while i&lt;5</text>
</g>
<g id="edge1" class="edge"><title>p0x7fdba4000030&#45;&gt;p0x7fdba4000140</title>
<path fill="none" stroke="black" d="M57.9853,-61C65.9604,-61 75.1139,-61 84.7262,-61"/>
<polygon points="84.8793,-64.5001 94.8793,-61 84.8792,-57.5001 84.8793,-64.5001"/>
</g>
<g id="node3" class="node"><title>p0x7fdba4000470</title>
<ellipse cx="345.874" cy="-116" rx="38.7821" ry="18.2703"/>
<text text-anchor="middle" x="345.874" y="-112.2">done</text>
</g>
<g id="edge2" class="edge"><title>p0x7fdba4000140&#45;&gt;p0x7fdba4000470</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M219.14,-74.314C244.904,-82.8557 278.251,-93.9118 304.129,-102.491"/>
<polygon points="303.056,-105.823 313.65,-105.648 305.259,-99.1786 303.056,-105.823"/>
<text text-anchor="middle" x="283.983" y="-101.2">1</text>
</g>
<g id="node4" class="node"><title>p0x7fdba4000250</title>
<ellipse cx="345.874" cy="-61" rx="27.6545" ry="18.2703"/>
<text text-anchor="middle" x="345.874" y="-57.2">i++</text>
</g>
<g id="edge3" class="edge"><title>p0x7fdba4000140&#45;&gt;p0x7fdba4000250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M261.442,-61C277.772,-61 294.126,-61 307.974,-61"/>
<polygon points="308.033,-64.5001 318.033,-61 308.033,-57.5001 308.033,-64.5001"/>
<text text-anchor="middle" x="283.983" y="-66.2">0</text>
</g>
<g id="node5" class="node"><title>p0x7fdba4000360</title>
<polygon points="474.765,-52 421.765,-26 474.765,3.55271e-15 527.765,-26 474.765,-52"/>
<text text-anchor="middle" x="474.765" y="-22.2">back</text>
</g>
<g id="edge4" class="edge"><title>p0x7fdba4000250&#45;&gt;p0x7fdba4000360</title>
<path fill="none" stroke="black" d="M371.641,-54.1686C388.423,-49.5395 411.044,-43.3 430.731,-37.8699"/>
<polygon points="431.706,-41.2318 440.415,-35.1987 429.844,-34.4837 431.706,-41.2318"/>
</g>
<g id="edge5" class="edge"><title>p0x7fdba4000360&#45;&gt;p0x7fdba4000140</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M432.637,-20.4072C417.605,-18.6199 400.444,-16.8781 384.765,-16 350.249,-14.067 341.06,-10.1844 306.983,-16 277.67,-21.0026 246.14,-32.0145 221.708,-41.8923"/>
<polygon points="220.281,-38.695 212.376,-45.7493 222.954,-45.1643 220.281,-38.695"/>
<text text-anchor="middle" x="345.874" y="-21.2">0</text>
</g>
</g>
</svg>
</div><p>The program outputs:</p><pre class="m-code"><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">i</span><span class="o">++=</span><span class="mi">0</span><span class="w"></span>
<span class="n">back</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">i</span><span class="o">++=</span><span class="mi">1</span><span class="w"></span>
<span class="n">back</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">i</span><span class="o">++=</span><span class="mi">2</span><span class="w"></span>
<span class="n">back</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">i</span><span class="o">++=</span><span class="mi">3</span><span class="w"></span>
<span class="n">back</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">i</span><span class="o">++=</span><span class="mi">4</span><span class="w"></span>
<span class="n">back</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="w"></span>
<span class="n">done</span><span class="w"></span></pre><p>Notice that, when you implement a while-loop block, you cannot direct a dependency from the body task to the loop condition task. Doing so will introduce a strong dependency between the body task and the loop condition task, and the loop condition task will never be executed. The following code shows a common faulty implementation of while-loop control flow.</p><pre class="m-code"><span class="c1">// wrong implementation of while-loop using only one condition task</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">init</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i=0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;while i&lt;5</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;i++=&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="n">init</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span>
<span class="n">cond</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">);</span><span class="w"></span>
<span class="n">body</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">cond</span><span class="p">);</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 24.562rem; height: 6.812rem;" viewBox="0.00 0.00 392.76 108.77">
<g transform="scale(1 1) rotate(0) translate(4 104.77)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7fdba4000030</title>
<ellipse cx="28.9914" cy="-41.3848" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-37.5848">init</text>
</g>
<g id="node2" class="node"><title>p0x7fdba4000140</title>
<polygon points="177.983,-67.3848 94.9828,-41.3848 177.983,-15.3848 260.983,-41.3848 177.983,-67.3848"/>
<text text-anchor="middle" x="177.983" y="-37.5848">while i&lt;5</text>
</g>
<g id="edge1" class="edge"><title>p0x7fdba4000030&#45;&gt;p0x7fdba4000140</title>
<path fill="none" stroke="black" d="M57.9853,-41.3848C65.9604,-41.3848 75.1139,-41.3848 84.7262,-41.3848"/>
<polygon points="84.8793,-44.8849 94.8793,-41.3848 84.8792,-37.8849 84.8793,-44.8849"/>
</g>
<g id="node3" class="node"><title>p0x7fdba4000470</title>
<ellipse cx="345.874" cy="-82.3848" rx="38.7821" ry="18.2703"/>
<text text-anchor="middle" x="345.874" y="-78.5848">done</text>
</g>
<g id="edge2" class="edge"><title>p0x7fdba4000140&#45;&gt;p0x7fdba4000470</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M225.193,-52.8056C248.91,-58.6674 277.649,-65.7703 301.02,-71.5464"/>
<polygon points="300.462,-75.0136 311.009,-74.0152 302.141,-68.218 300.462,-75.0136"/>
<text text-anchor="middle" x="283.983" y="-72.5848">1</text>
</g>
<g id="node4" class="node"><title>p0x7fdba4000250</title>
<ellipse cx="345.874" cy="-18.3848" rx="27.6545" ry="18.2703"/>
<text text-anchor="middle" x="345.874" y="-14.5848">i++</text>
</g>
<g id="edge3" class="edge"><title>p0x7fdba4000140&#45;&gt;p0x7fdba4000250</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M236.073,-33.4695C260.126,-30.1346 287.402,-26.3529 308.627,-23.4102"/>
<polygon points="309.398,-26.8369 318.822,-21.9967 308.436,-19.9033 309.398,-26.8369"/>
<text text-anchor="middle" x="283.983" y="-32.5848">0</text>
</g>
<g id="edge4" class="edge"><title>p0x7fdba4000250&#45;&gt;p0x7fdba4000140</title>
<path fill="none" stroke="black" d="M318.201,-19.7862C306.187,-20.5774 291.842,-21.7439 278.983,-23.3848 266.015,-25.0395 252.175,-27.2446 239.054,-29.5429"/>
<polygon points="238.413,-26.1019 229.187,-31.3109 239.648,-32.9921 238.413,-26.1019"/>
</g>
</g>
</svg>
</div><p>In the taskflow diagram above, the scheduler starts with <code>init</code> and then decrements the strong dependency of the loop condition task, <code>while i&lt;5</code>. After this, there remains one strong dependency, i.e., introduced by the loop body task, <code>i++</code>. However, task <code>i++</code> will not be executed until the loop condition task returns <code>0</code>, causing a deadlock.</p></section></section><section id="CreateAMultiConditionTask"><h2><a href="#CreateAMultiConditionTask">Create a Multi-condition Task</a></h2><p>A <em>multi-condition task</em> is a generalized version of conditional tasking. In some cases, applications need to jump to multiple branches from a parent task. This can be done by creating a <em>multi-condition task</em> which allows a task to select one or more successor tasks to execute. Similar to a condition task, a multi-condition task returns a vector of integer indices that indicate the successors to execute when the multi-condition task completes. The index is defined with respect to the order of successors preceded by a multi-condition task. For example, the following code creates a multi-condition task, <code>A</code>, that informs the scheduler to run on its two successors, <code>B</code> and <code>D</code>.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">SmallVector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;B</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;B&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;C</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;C&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;D</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;D&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>

<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><div class="m-graph"><svg style="width: 12.875rem; height: 9.438rem;" viewBox="0.00 0.00 206.00 150.77">
<g transform="scale(1 1) rotate(0) translate(4 146.77)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7bc400014030</title>
<polygon points="99,-142.77 72,-116.77 99,-90.7696 126,-116.77 99,-142.77"/>
<text text-anchor="middle" x="99" y="-112.97">A</text>
</g>
<g id="node2" class="node"><title>p0x7bc400014118</title>
<ellipse cx="27" cy="-18.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="27" y="-14.5848">B</text>
</g>
<g id="edge1" class="edge"><title>p0x7bc400014030&#45;&gt;p0x7bc400014118</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88.0647,-101.131C76.6379,-85.8339 58.5225,-61.5832 44.9855,-43.4615"/>
<polygon points="47.5459,-41.0407 38.7572,-35.1238 41.9378,-45.23 47.5459,-41.0407"/>
<text text-anchor="middle" x="71" y="-59.9696">0</text>
</g>
<g id="node3" class="node"><title>p0x7bc400014200</title>
<ellipse cx="99" cy="-18.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="99" y="-14.5848">C</text>
</g>
<g id="edge2" class="edge"><title>p0x7bc400014030&#45;&gt;p0x7bc400014200</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M99,-90.6972C99,-77.4055 99,-61.0387 99,-47.3385"/>
<polygon points="102.5,-47.0325 99,-37.0326 95.5001,-47.0326 102.5,-47.0325"/>
<text text-anchor="middle" x="104" y="-59.9696">1</text>
</g>
<g id="node4" class="node"><title>p0x7bc4000142e8</title>
<ellipse cx="171" cy="-18.3848" rx="27" ry="18.2703"/>
<text text-anchor="middle" x="171" y="-14.5848">D</text>
</g>
<g id="edge3" class="edge"><title>p0x7bc400014030&#45;&gt;p0x7bc4000142e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M109.935,-101.131C121.362,-85.8339 139.477,-61.5832 153.015,-43.4615"/>
<polygon points="156.062,-45.23 159.243,-35.1238 150.454,-41.0407 156.062,-45.23"/>
<text text-anchor="middle" x="148" y="-59.9696">2</text>
</g>
</g>
</svg>
</div><aside class="m-note m-info"><h4>Note</h4><p>The return type of a multi-condition task is <a href="classtf_1_1SmallVector.html" class="m-doc">tf::<wbr />SmallVector</a>, which provides C++ vector-style functionalities but comes with small buffer optimization.</p></aside><p>One important application of conditional tasking is implementing <em>iterative control flow</em>. You can use multi-condition tasks to create multiple loops that run concurrently. The following code creates a sequential chain of four loops in which each loop increments a counter variable ten times. When the program completes, the value of the counter variable is <code>40</code>.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="n">std</span><span class="o">::</span><span class="n">atomic</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counter</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="w"></span>

<span class="k">auto</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="kt">bool</span><span class="p">{</span><span class="nb">true</span><span class="p">},</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">0</span><span class="p">)]()</span><span class="w"> </span><span class="k">mutable</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">SmallVector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">counter</span><span class="p">.</span><span class="n">fetch_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">memory_order_relaxed</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="o">++</span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){});</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">loop</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">loop</span><span class="p">);</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">loop</span><span class="p">);</span><span class="w"></span>

<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w"></span>
<span class="n">B</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">);</span><span class="w"></span>
<span class="n">C</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="n">D</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">D</span><span class="p">);</span><span class="w"></span>

<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w">  </span><span class="c1">// counter == 40</span></pre><div class="m-graph"><svg style="width: 28.688rem; height: 6.000rem;" viewBox="0.00 0.00 458.98 96.00">
<g transform="scale(1 1) rotate(0) translate(4 92)">
<title>Taskflow</title>
<g id="node1" class="node"><title>p0x7bc400014030</title>
<ellipse cx="28.9914" cy="-26" rx="28.9828" ry="18.2703"/>
<text text-anchor="middle" x="28.9914" y="-22.2">init</text>
</g>
<g id="node2" class="node"><title>p0x7bc400014118</title>
<polygon points="121.983,-52 94.9828,-26 121.983,-0 148.983,-26 121.983,-52"/>
<text text-anchor="middle" x="121.983" y="-22.2">A</text>
</g>
<g id="edge1" class="edge"><title>p0x7bc400014030&#45;&gt;p0x7bc400014118</title>
<path fill="none" stroke="black" d="M58.2828,-26C66.6821,-26 75.9988,-26 84.8255,-26"/>
<polygon points="84.8778,-29.5001 94.8778,-26 84.8778,-22.5001 84.8778,-29.5001"/>
</g>
<g id="edge2" class="edge"><title>p0x7bc400014118&#45;&gt;p0x7bc400014118</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114.46,-44.9951C112.342,-57.6662 114.85,-70 121.983,-70 127.165,-70 129.906,-63.4891 130.205,-55.0684"/>
<polygon points="133.69,-54.7285 129.506,-44.9951 126.707,-55.2136 133.69,-54.7285"/>
<text text-anchor="middle" x="121.983" y="-75.2">0</text>
</g>
<g id="node3" class="node"><title>p0x7bc400014200</title>
<polygon points="221.983,-52 194.983,-26 221.983,-0 248.983,-26 221.983,-52"/>
<text text-anchor="middle" x="221.983" y="-22.2">B</text>
</g>
<g id="edge3" class="edge"><title>p0x7bc400014118&#45;&gt;p0x7bc400014200</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148.988,-26C159.952,-26 172.903,-26 184.777,-26"/>
<polygon points="184.856,-29.5001 194.856,-26 184.856,-22.5001 184.856,-29.5001"/>
<text text-anchor="middle" x="171.983" y="-31.2">1</text>
</g>
<g id="edge4" class="edge"><title>p0x7bc400014200&#45;&gt;p0x7bc400014200</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213.617,-44.0787C210.893,-57.0646 213.682,-70 221.983,-70 228.079,-70 231.202,-63.0239 231.352,-54.1747"/>
<polygon points="234.821,-53.6834 230.348,-44.0787 227.855,-54.3759 234.821,-53.6834"/>
<text text-anchor="middle" x="221.983" y="-75.2">0</text>
</g>
<g id="node4" class="node"><title>p0x7bc4000142e8</title>
<polygon points="321.983,-52 294.983,-26 321.983,-0 348.983,-26 321.983,-52"/>
<text text-anchor="middle" x="321.983" y="-22.2">C</text>
</g>
<g id="edge5" class="edge"><title>p0x7bc400014200&#45;&gt;p0x7bc4000142e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248.988,-26C259.952,-26 272.903,-26 284.777,-26"/>
<polygon points="284.856,-29.5001 294.856,-26 284.856,-22.5001 284.856,-29.5001"/>
<text text-anchor="middle" x="271.983" y="-31.2">1</text>
</g>
<g id="edge6" class="edge"><title>p0x7bc4000142e8&#45;&gt;p0x7bc4000142e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313.617,-44.0787C310.893,-57.0646 313.682,-70 321.983,-70 328.079,-70 331.202,-63.0239 331.352,-54.1747"/>
<polygon points="334.821,-53.6834 330.348,-44.0787 327.855,-54.3759 334.821,-53.6834"/>
<text text-anchor="middle" x="321.983" y="-75.2">0</text>
</g>
<g id="node5" class="node"><title>p0x7bc4000143d0</title>
<polygon points="422.983,-52 394.983,-26 422.983,-0 450.983,-26 422.983,-52"/>
<text text-anchor="middle" x="422.983" y="-22.2">D</text>
</g>
<g id="edge7" class="edge"><title>p0x7bc4000142e8&#45;&gt;p0x7bc4000143d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M348.994,-26C359.894,-26 372.772,-26 384.653,-26"/>
<polygon points="384.763,-29.5001 394.763,-26 384.763,-22.5001 384.763,-29.5001"/>
<text text-anchor="middle" x="371.983" y="-31.2">1</text>
</g>
<g id="edge8" class="edge"><title>p0x7bc4000143d0&#45;&gt;p0x7bc4000143d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M414.523,-44.537C411.96,-57.3672 414.78,-70 422.983,-70 428.943,-70 432.061,-63.3312 432.338,-54.7633"/>
<polygon points="435.801,-54.1936 431.442,-44.537 428.828,-54.8042 435.801,-54.1936"/>
<text text-anchor="middle" x="422.983" y="-75.2">0</text>
</g>
</g>
</svg>
</div><aside class="m-note m-warning"><h4>Attention</h4><p>It is your responsibility to ensure the return of a multi-condition task goes to a correct successor task. If a returned index falls outside the successor range of a multi-condition task, the scheduler will skip that index without doing anything.</p></aside></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2022.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.11 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
