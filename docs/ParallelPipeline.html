<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Taskflow Algorithms &raquo; Parallel Pipeline | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="Algorithms.html">Taskflow Algorithms</a> &raquo;</span>
          Parallel Pipeline
        </h1>
<p>Taskflow provides a <em>task-parallel</em> pipeline programming framework for you to create a <em>pipeline scheduling framework</em>. Pipeline parallelism refers to a parallel execution of multiple data tokens through a linear chain of pipes or stages. Each stage processes the data token sent from the previous stage, applies the given callable to that data token, and then sends the result to the next stage. Multiple data tokens can be processed simultaneously across different stages.</p><section id="ParallelPipelineIncludeHeaderFile"><h2><a href="#ParallelPipelineIncludeHeaderFile">Include the Header</a></h2><p>You need to include the header file, <code>taskflow/algorithm/pipeline.hpp</code>, for creating a pipeline scheduling framework.</p><pre class="m-code"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;taskflow/algorithm/pipeline.hpp&gt;</span><span class="cp"></span></pre></section><section id="UnderstandPipelineScheduling"><h2><a href="#UnderstandPipelineScheduling">Understand the Pipeline Scheduling Framework</a></h2><p>A <a href="classtf_1_1Pipeline.html" class="m-doc">tf::<wbr />Pipeline</a> object is a <em>composable</em> graph to create a <em>pipeline scheduling framework</em> through a module task in a taskflow (see <a href="ComposableTasking.html" class="m-doc">Composable Tasking</a>). Unlike the conventional pipeline programming frameworks (e.g., Intel TBB Parallel <a href="classtf_1_1Pipeline.html" class="m-doc">Pipeline</a>), Taskflow&#x27;s pipeline algorithm does not provide any data abstraction, which often restricts users from optimizing data layouts in their applications, but a flexible framework for users to customize their application data atop an efficient pipeline scheduling framework.</p><div class="m-graph"><svg style="width: 21.750rem; height: 22.688rem;" viewBox="0.00 0.00 348.00 363.08">
<g transform="scale(1 1) rotate(0) translate(4 359.078)">
<title>Taskflow</title>
<g id="clust4" class="cluster"><title>cluster0</title>
<polygon stroke-dasharray="5,2" points="8,-268.309 8,-347.078 332,-347.078 332,-268.309 8,-268.309"/>
<text text-anchor="middle" x="170" y="-330.278">line 0</text>
</g>
<g id="clust5" class="cluster"><title>cluster1</title>
<polygon stroke-dasharray="5,2" points="8,-181.539 8,-260.309 332,-260.309 332,-181.539 8,-181.539"/>
<text text-anchor="middle" x="170" y="-243.509">line 1</text>
</g>
<g id="clust6" class="cluster"><title>cluster2</title>
<polygon stroke-dasharray="5,2" points="8,-94.7696 8,-173.539 332,-173.539 332,-94.7696 8,-94.7696"/>
<text text-anchor="middle" x="170" y="-156.739">line 2</text>
</g>
<g id="clust7" class="cluster"><title>cluster3</title>
<polygon stroke-dasharray="5,2" points="8,-8 8,-86.7696 332,-86.7696 332,-8 8,-8"/>
<text text-anchor="middle" x="170" y="-69.9696">line 3</text>
</g>
<g id="node1" class="node"><title>p00</title>
<ellipse cx="61" cy="-294.693" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="61" y="-290.893">pipe&#45;0</text>
</g>
<g id="node2" class="node"><title>p10</title>
<ellipse cx="61" cy="-207.924" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="61" y="-204.124">pipe&#45;0</text>
</g>
<g id="edge9" class="edge"><title>p00&#45;&gt;p10</title>
<path fill="none" stroke="black" d="M61,-276.129C61,-264.763 61,-249.72 61,-236.749"/>
<polygon points="64.5001,-236.466 61,-226.466 57.5001,-236.466 64.5001,-236.466"/>
</g>
<g id="node5" class="node"><title>p01</title>
<ellipse cx="170" cy="-294.693" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="170" y="-290.893">pipe&#45;1</text>
</g>
<g id="edge1" class="edge"><title>p00&#45;&gt;p01</title>
<path fill="none" stroke="black" d="M106.559,-294.693C109.161,-294.693 111.763,-294.693 114.365,-294.693"/>
<polygon points="114.402,-298.194 124.401,-294.693 114.401,-291.194 114.402,-298.194"/>
</g>
<g id="node3" class="node"><title>p20</title>
<ellipse cx="61" cy="-121.154" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="61" y="-117.354">pipe&#45;0</text>
</g>
<g id="edge11" class="edge"><title>p10&#45;&gt;p20</title>
<path fill="none" stroke="black" d="M61,-189.36C61,-177.994 61,-162.951 61,-149.979"/>
<polygon points="64.5001,-149.696 61,-139.696 57.5001,-149.696 64.5001,-149.696"/>
</g>
<g id="node6" class="node"><title>p11</title>
<ellipse cx="170" cy="-207.924" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="170" y="-204.124">pipe&#45;1</text>
</g>
<g id="edge3" class="edge"><title>p10&#45;&gt;p11</title>
<path fill="none" stroke="black" d="M106.559,-207.924C109.161,-207.924 111.763,-207.924 114.365,-207.924"/>
<polygon points="114.402,-211.424 124.401,-207.924 114.401,-204.424 114.402,-211.424"/>
</g>
<g id="node4" class="node"><title>p30</title>
<ellipse cx="61" cy="-34.3848" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="61" y="-30.5848">pipe&#45;0</text>
</g>
<g id="edge13" class="edge"><title>p20&#45;&gt;p30</title>
<path fill="none" stroke="black" d="M61,-102.59C61,-91.224 61,-76.1812 61,-63.2095"/>
<polygon points="64.5001,-62.9265 61,-52.9266 57.5001,-62.9266 64.5001,-62.9265"/>
</g>
<g id="node7" class="node"><title>p21</title>
<ellipse cx="170" cy="-121.154" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="170" y="-117.354">pipe&#45;1</text>
</g>
<g id="edge5" class="edge"><title>p20&#45;&gt;p21</title>
<path fill="none" stroke="black" d="M106.559,-121.154C109.161,-121.154 111.763,-121.154 114.365,-121.154"/>
<polygon points="114.402,-124.654 124.401,-121.154 114.401,-117.654 114.402,-124.654"/>
</g>
<g id="node8" class="node"><title>p31</title>
<ellipse cx="170" cy="-34.3848" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="170" y="-30.5848">pipe&#45;1</text>
</g>
<g id="edge7" class="edge"><title>p30&#45;&gt;p31</title>
<path fill="none" stroke="black" d="M106.559,-34.3848C109.161,-34.3848 111.763,-34.3848 114.365,-34.3848"/>
<polygon points="114.402,-37.8849 124.401,-34.3848 114.401,-30.8849 114.402,-37.8849"/>
</g>
<g id="node9" class="node"><title>p02</title>
<ellipse cx="279" cy="-294.693" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="279" y="-290.893">pipe&#45;2</text>
</g>
<g id="edge2" class="edge"><title>p01&#45;&gt;p02</title>
<path fill="none" stroke="black" d="M215.559,-294.693C218.161,-294.693 220.763,-294.693 223.365,-294.693"/>
<polygon points="223.402,-298.194 233.401,-294.693 223.401,-291.194 223.402,-298.194"/>
</g>
<g id="node10" class="node"><title>p12</title>
<ellipse cx="279" cy="-207.924" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="279" y="-204.124">pipe&#45;2</text>
</g>
<g id="edge4" class="edge"><title>p11&#45;&gt;p12</title>
<path fill="none" stroke="black" d="M215.559,-207.924C218.161,-207.924 220.763,-207.924 223.365,-207.924"/>
<polygon points="223.402,-211.424 233.401,-207.924 223.401,-204.424 223.402,-211.424"/>
</g>
<g id="node11" class="node"><title>p22</title>
<ellipse cx="279" cy="-121.154" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="279" y="-117.354">pipe&#45;2</text>
</g>
<g id="edge6" class="edge"><title>p21&#45;&gt;p22</title>
<path fill="none" stroke="black" d="M215.559,-121.154C218.161,-121.154 220.763,-121.154 223.365,-121.154"/>
<polygon points="223.402,-124.654 233.401,-121.154 223.401,-117.654 223.402,-124.654"/>
</g>
<g id="node12" class="node"><title>p32</title>
<ellipse cx="279" cy="-34.3848" rx="45.011" ry="18.2703"/>
<text text-anchor="middle" x="279" y="-30.5848">pipe&#45;2</text>
</g>
<g id="edge8" class="edge"><title>p31&#45;&gt;p32</title>
<path fill="none" stroke="black" d="M215.559,-34.3848C218.161,-34.3848 220.763,-34.3848 223.365,-34.3848"/>
<polygon points="223.402,-37.8849 233.401,-34.3848 223.401,-30.8849 223.402,-37.8849"/>
</g>
<g id="edge10" class="edge"><title>p02&#45;&gt;p12</title>
<path fill="none" stroke="black" d="M279,-276.129C279,-264.763 279,-249.72 279,-236.749"/>
<polygon points="282.5,-236.466 279,-226.466 275.5,-236.466 282.5,-236.466"/>
</g>
<g id="edge12" class="edge"><title>p12&#45;&gt;p22</title>
<path fill="none" stroke="black" d="M279,-189.36C279,-177.994 279,-162.951 279,-149.979"/>
<polygon points="282.5,-149.696 279,-139.696 275.5,-149.696 282.5,-149.696"/>
</g>
<g id="edge14" class="edge"><title>p22&#45;&gt;p32</title>
<path fill="none" stroke="black" d="M279,-102.59C279,-91.224 279,-76.1812 279,-63.2095"/>
<polygon points="282.5,-62.9265 279,-52.9266 275.5,-62.9266 282.5,-62.9265"/>
</g>
</g>
</svg>
</div><p>The figure above gives an example of our pipeline scheduling framework. The framework consists of three <em>pipes</em> (serial-parallel-serial stages) and four <em>lines</em> (maximum parallelism), where each line processes at most one data token. A pipeline of three pipes and four lines will propagate each data token through a sequential chain of three pipes and can simultaneously process up to four data tokens at the four lines. Each edge represents a task dependency. For example, the edge from <code>pipe-0</code> to <code>pipe-1</code> in line <code>0</code> represents the task dependency between the first and the second pipes in the first line; the edge from <code>pipe-0</code> in line <code>0</code> to <code>pipe-0</code> in line <code>1</code> represents the task dependency between two adjacent lines when processing two data tokens at the same pipe. Each pipe can be either a <em>serial</em> type or a <em>parallel</em> type, where a serial pipe processes data tokens sequentially and a parallel pipe processes different data tokens simultaneously.</p><aside class="m-note m-info"><h4>Note</h4><p>Due to the nature of pipeline, Taskflow requires the first pipe to be a serial type. The pipeline scheduling algorithm operates in a circular fashion with a factor of line count.</p></aside></section><section id="CreatePipeline"><h2><a href="#CreatePipeline">Create a Pipeline Module Task</a></h2><p>Taskflow leverages modern C++ and template techniques to strike a balance between the <em>expressiveness</em> and <em>generality</em> in designing the pipeline programming model. In general, there are three steps to create a pipeline application:</p><ol><li>Define the pipeline structure (e.g., pipe type, pipe callable, stopping rule, line count)</li><li>Define the data storage and layout, if needed for the application</li><li>Define the pipeline taskflow graph using composition</li></ol><p>The following code creates a pipeline scheduling framework using the example from the previous section. The framework schedules a total of five <em>scheduling tokens</em> labeled from 0 to 4. The first pipe stores the token identifier in a custom data storage, <code>buffer</code>, and each of the rest pipes adds one to the input data from the result of the previous pipe and stores the result into the corresponding line entry in the buffer.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="c1">// maximum parallelism - each line processes one token at a time</span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="c1">// custom data storage</span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline consists of three pipes (serial-parallel-serial)</span>
<span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">13</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">14</span><span class="o">:</span><span class="w">     </span><span class="c1">// generate only 5 scheduling tokens</span>
<span class="mi">15</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">16</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">17</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">18</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">19</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">20</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="mi">21</span><span class="o">:</span><span class="w">       </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">();</span><span class="w"></span>
<span class="mi">22</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">23</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">24</span><span class="o">:</span><span class="w"></span>
<span class="mi">25</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">26</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">27</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipe 1: input buffer[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="mi">28</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">29</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">30</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">31</span><span class="o">:</span><span class="w">     </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">32</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">33</span><span class="o">:</span><span class="w"></span>
<span class="mi">34</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">35</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">36</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipe 2: input buffer[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="mi">37</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">38</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">39</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">40</span><span class="o">:</span><span class="w">     </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">41</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">42</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">43</span><span class="o">:</span><span class="w"></span>
<span class="mi">44</span><span class="o">:</span><span class="w"> </span><span class="c1">// build the pipeline graph using composition</span>
<span class="mi">45</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">46</span><span class="o">:</span><span class="w"></span>
<span class="mi">47</span><span class="o">:</span><span class="w"> </span><span class="c1">// execute the taskflow</span>
<span class="mi">48</span><span class="o">:</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><p>Debrief:</p><ul><li>Lines 4-5 define the structure of the pipeline scheduling framework</li><li>Line 8 defines the data storage as an one-dimensional array of <code>num_lines</code> integers</li><li>Line 12 defines the number of lines in the pipeline</li><li>Lines 13-23 define the first serial pipe, which will stop the pipeline scheduling at the fifth token</li><li>Lines 25-32 define the second parallel pipe</li><li>Lines 34-41 define the third serial pipe</li><li>Line 45 defines the pipeline taskflow graph using composition</li><li>Line 48 executes the taskflow</li></ul><p>Taskflow leverages <a href="RuntimeTasking.html" class="m-doc">Runtime Tasking</a> and <a href="ComposableTasking.html" class="m-doc">Composable Tasking</a> to implement the pipeline scheduling framework. The taskflow graph of this pipeline example is shown as follows, where 1) one condition task is used to decide which runtime task to run and 2) four runtime tasks is used to schedule tokens at four parallel lines, respectively.</p><div class="m-graph"><svg style="width: 28.125rem; height: 13.000rem;" viewBox="0.00 0.00 450.00 208.00">
<g transform="scale(1 1) rotate(0) translate(4 204)">
<title>Taskflow</title>
<g id="clust1" class="cluster"><title>cluster_p0x7ffc47e53358</title>
<polygon points="8,-106 8,-184 140,-184 140,-106 8,-106"/>
<text text-anchor="middle" x="74" y="-167.2">Taskflow</text>
</g>
<g id="clust2" class="cluster"><title>cluster_p0x7ffc47e53220</title>
<polygon points="148,-8 148,-192 434,-192 434,-8 148,-8"/>
<text text-anchor="middle" x="291" y="-175.2">m1</text>
</g>
<g id="node1" class="node"><title>p0x1878a88</title>
<polygon points="132,-150 20,-150 16,-146 16,-114 128,-114 132,-118 132,-150"/>
<polyline points="128,-146 16,-146 "/>
<polyline points="128,-146 128,-114 "/>
<polyline points="128,-146 132,-150 "/>
<text text-anchor="middle" x="74" y="-128.2">pipeline [m1]</text>
</g>
<g id="node2" class="node"><title>p0x1878600</title>
<polygon points="281,-158 228,-132 281,-106 334,-132 281,-158"/>
<text text-anchor="middle" x="281" y="-128.2">cond</text>
</g>
<g id="node3" class="node"><title>p0x18786e8</title>
<polygon points="210,-52 156,-52 156,-48 152,-48 152,-44 156,-44 156,-24 152,-24 152,-20 156,-20 156,-16 210,-16 210,-52"/>
<polyline points="156,-48 160,-48 160,-44 156,-44 "/>
<polyline points="156,-24 160,-24 160,-20 156,-20 "/>
<text text-anchor="middle" x="183" y="-30.2">rt&#45;0</text>
</g>
<g id="edge1" class="edge"><title>p0x1878600&#45;&gt;p0x18786e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263.93,-114.278C248.383,-99.0485 225.24,-76.3781 207.68,-59.1764"/>
<polygon points="210.127,-56.6743 200.535,-52.1767 205.229,-61.6748 210.127,-56.6743"/>
<text text-anchor="middle" x="240" y="-75.2">0</text>
</g>
<g id="node4" class="node"><title>p0x18787d0</title>
<polygon points="282,-52 228,-52 228,-48 224,-48 224,-44 228,-44 228,-24 224,-24 224,-20 228,-20 228,-16 282,-16 282,-52"/>
<polyline points="228,-48 232,-48 232,-44 228,-44 "/>
<polyline points="228,-24 232,-24 232,-20 228,-20 "/>
<text text-anchor="middle" x="255" y="-30.2">rt&#45;1</text>
</g>
<g id="edge2" class="edge"><title>p0x1878600&#45;&gt;p0x18787d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274.97,-108.734C271.203,-94.8282 266.329,-76.8306 262.339,-62.0978"/>
<polygon points="265.611,-60.7895 259.618,-52.0523 258.854,-62.6195 265.611,-60.7895"/>
<text text-anchor="middle" x="274" y="-75.2">1</text>
</g>
<g id="node5" class="node"><title>p0x18788b8</title>
<polygon points="354,-52 300,-52 300,-48 296,-48 296,-44 300,-44 300,-24 296,-24 296,-20 300,-20 300,-16 354,-16 354,-52"/>
<polyline points="300,-48 304,-48 304,-44 300,-44 "/>
<polyline points="300,-24 304,-24 304,-20 300,-20 "/>
<text text-anchor="middle" x="327" y="-30.2">rt&#45;2</text>
</g>
<g id="edge3" class="edge"><title>p0x1878600&#45;&gt;p0x18788b8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M290.755,-110.641C297.657,-96.2379 306.972,-76.7981 314.43,-61.2327"/>
<polygon points="317.631,-62.652 318.796,-52.1214 311.318,-59.6271 317.631,-62.652"/>
<text text-anchor="middle" x="314" y="-75.2">2</text>
</g>
<g id="node6" class="node"><title>p0x18789a0</title>
<polygon points="426,-52 372,-52 372,-48 368,-48 368,-44 372,-44 372,-24 368,-24 368,-20 372,-20 372,-16 426,-16 426,-52"/>
<polyline points="372,-48 376,-48 376,-44 372,-44 "/>
<polyline points="372,-24 376,-24 376,-20 372,-20 "/>
<text text-anchor="middle" x="399" y="-30.2">rt&#45;3</text>
</g>
<g id="edge4" class="edge"><title>p0x1878600&#45;&gt;p0x18789a0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M300.221,-115.362C319.099,-100.004 348.148,-76.3714 369.864,-58.7035"/>
<polygon points="372.244,-61.2797 377.792,-52.2538 367.826,-55.8497 372.244,-61.2797"/>
<text text-anchor="middle" x="359" y="-75.2">3</text>
</g>
</g>
</svg>
</div><p>In this example, we customize the data storage, <code>buffer</code>, as an one-dimensional array of 4 integers, since the pipeline structure defines only four parallel lines. Each entry of <code>buffer</code> stores stores the data being processed in the corresponding line. For example, <code>buffer[1]</code> stores the processed data at line <code>1</code>. The following figure shows the data layout of <code>buffer</code>.</p><div class="m-graph"><svg style="width: 17.938rem; height: 7.062rem;" viewBox="0.00 0.00 287.00 113.00">
<g transform="scale(1 1) rotate(0) translate(4 109)">
<title>structs</title>
<g id="node1" class="node"><title>struct1</title>
<polygon points="0,-0.5 0,-104.5 279,-104.5 279,-0.5 0,-0.5"/>
<text text-anchor="middle" x="139.5" y="-87.7">buffer[0] (processes token at line 0)</text>
<polyline points="0,-78.5 279,-78.5 "/>
<text text-anchor="middle" x="139.5" y="-61.7">buffer[1] (processes token at line 1)</text>
<polyline points="0,-52.5 279,-52.5 "/>
<text text-anchor="middle" x="139.5" y="-35.7">buffer[2] (processes token at line 2)</text>
<polyline points="0,-26.5 279,-26.5 "/>
<text text-anchor="middle" x="139.5" y="-9.7">buffer[3] (processes token at line 3)</text>
</g>
</g>
</svg>
</div><aside class="m-note m-info"><h4>Note</h4><p>In practice, you may need to add padding to the data type of the buffer or align it with the cacheline size to avoid false sharing. If the data type varies at different pipes, you can use <a href="https://en.cppreference.com/w/cpp/utility/variant">std::<wbr />variant</a> to store the data types in a uniform storage.</p></aside><p>For each scheduling token, you can use <a href="classtf_1_1Pipeflow.html#a579d15bb66fbcc2ab63d0570abe6c971" class="m-doc">tf::<wbr />Pipeflow::<wbr />line()</a> to get its line identifier and <a href="classtf_1_1Pipeflow.html#ac31ced16a1d60a5b7c6007549b8d39a4" class="m-doc">tf::<wbr />Pipeflow::<wbr />pipe()</a> to get its pipe identifier. For example, if a scheduling token is at the third pipe of the forth line, <a href="classtf_1_1Pipeflow.html#a579d15bb66fbcc2ab63d0570abe6c971" class="m-doc">tf::<wbr />Pipeflow::<wbr />line()</a> will return <code>3</code> and <a href="classtf_1_1Pipeflow.html#ac31ced16a1d60a5b7c6007549b8d39a4" class="m-doc">tf::<wbr />Pipeflow::<wbr />pipe()</a> will return <code>2</code> (index starts from 0). To stop the execution of the pipeline, you need to call <a href="classtf_1_1Pipeflow.html#a830b7f204cb87fff17e8d424918d9453" class="m-doc">tf::<wbr />Pipeflow::<wbr />stop()</a> at the first pipe. Once the stop signal has been triggered, the pipeline will stop scheduling any new tokens after the callable. As we can see from this example, <a href="classtf_1_1Pipeline.html" class="m-doc">tf::<wbr />Pipeline</a> gives you the full control to customize your application data on top of a pipeline scheduling framework.</p><aside class="m-note m-info"><h4>Note</h4><ol><li>Calling <a href="classtf_1_1Pipeflow.html#a830b7f204cb87fff17e8d424918d9453" class="m-doc">tf::<wbr />Pipeflow::<wbr />stop()</a> not at the first pipe has no effect on the pipeline scheduling.</li><li>In most cases, <a href="http://en.cppreference.com/w/cpp/thread/thread/hardware_concurrency.html" class="m-doc-external">std::<wbr />thread::<wbr />hardware_concurrency</a> is a good number for line count.</li></ol></aside><p>Our pipeline algorithm schedules tokens in a <em>circular</em> manner, with a factor of <code>num_lines</code>. That is, token <code>t</code> will be processed at line <code>t % num_lines</code>. The following snippet shows one of the possible outputs of this pipeline program:</p><pre class="m-code"><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span></pre><p>There are a total of five tokens running through three pipes. Each pipes prints its input data value, except the first pipe that prints its token identifier. Since the second pipe is a parallel pipe, the output can interleave.</p></section><section id="ConnectWithTasks"><h2><a href="#ConnectWithTasks">Connect Pipeline with Other Tasks</a></h2><p>You can connect the pipeline module task with other tasks to create a taskflow application that embeds one or multiple pipeline algorithms. We describe three common examples below:</p><ul><li><a href="ParallelPipeline.html#IterateAPipeline" class="m-doc">Example 1: Iterate a Pipeline</a></li><li><a href="ParallelPipeline.html#ConcatenateTwoPipelines" class="m-doc">Example 2: Concatenate Two Pipelines</a></li><li><a href="ParallelPipeline.html#DefineMultipleParallelPipelines" class="m-doc">Example 3: Define Multiple Parallel Pipelines</a></li></ul><section id="IterateAPipeline"><h3><a href="#IterateAPipeline">Example 1: Iterate a Pipeline</a></h3><p>This example emulates a data streaming application that iteratively runs a stream of data through a pipeline using conditional tasking. The taskflow graph consists of one pipeline module task and one condition task. The pipeline module task processes a stream of data. The condition task decides the availability of data and reruns the pipeline when the next stream of data becomes available.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">  </span><span class="c1">// maximum parallelism of the pipeline</span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="c1">// custom data storage</span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline consists of three pipes (serial-parallel-serial)</span>
<span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">13</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">14</span><span class="o">:</span><span class="w">     </span><span class="c1">// only 5 scheduling tokens are processed</span>
<span class="mi">15</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">16</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">17</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">18</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">19</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">20</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;stage 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="mi">21</span><span class="o">:</span><span class="w">       </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">();</span><span class="w"></span>
<span class="mi">22</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">23</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">24</span><span class="o">:</span><span class="w"></span>
<span class="mi">25</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">26</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">27</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;stage 1: input buffer[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="mi">28</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">29</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">30</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">31</span><span class="o">:</span><span class="w">     </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">32</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">33</span><span class="o">:</span><span class="w"></span>
<span class="mi">34</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">35</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">36</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;stage 2: input buffer[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="mi">37</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">38</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">39</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">40</span><span class="o">:</span><span class="w">     </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">41</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">42</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">43</span><span class="o">:</span><span class="w"> </span>
<span class="mi">44</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">i</span><span class="p">](){</span><span class="w"></span>
<span class="mi">45</span><span class="o">:</span><span class="w">   </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="mi">46</span><span class="o">:</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="n">N</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span>
<span class="mi">47</span><span class="o">:</span><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rerun the pipeline</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="mi">48</span><span class="o">:</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="mi">49</span><span class="o">:</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="mi">50</span><span class="o">:</span><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">51</span><span class="o">:</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">52</span><span class="o">:</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="mi">53</span><span class="o">:</span><span class="w"> </span><span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;conditional&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">54</span><span class="o">:</span><span class="w"></span>
<span class="mi">55</span><span class="o">:</span><span class="w"> </span><span class="c1">// build the pipeline graph using composition</span>
<span class="mi">56</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="w"></span>
<span class="mi">57</span><span class="o">:</span><span class="w">                             </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">58</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">initial</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;initial</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w">  </span><span class="p">})</span><span class="w"></span>
<span class="mi">59</span><span class="o">:</span><span class="w">                             </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;initial&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">60</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">stop</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;stop</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="mi">61</span><span class="o">:</span><span class="w">                             </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;stop&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">62</span><span class="o">:</span><span class="w"></span>
<span class="mi">63</span><span class="o">:</span><span class="w"> </span><span class="c1">// specify the graph dependency</span>
<span class="mi">64</span><span class="o">:</span><span class="w"> </span><span class="n">initial</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline</span><span class="p">);</span><span class="w"></span>
<span class="mi">65</span><span class="o">:</span><span class="w"> </span><span class="n">pipeline</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">conditional</span><span class="p">);</span><span class="w"></span>
<span class="mi">66</span><span class="o">:</span><span class="w"> </span><span class="n">conditional</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="p">);</span><span class="w"></span>
<span class="mi">67</span><span class="o">:</span><span class="w"></span>
<span class="mi">68</span><span class="o">:</span><span class="w"> </span><span class="c1">// execute the taskflow</span>
<span class="mi">69</span><span class="o">:</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><p>Debrief:</p><ul><li>Lines 4-5 define the structure of the pipeline scheduling framework</li><li>Line 8 defines the data storage as an one-dimensional array (<code>num_lines</code> integers)</li><li>Line 12 defines the number of lines in the pipeline</li><li>Lines 13-23 define the first serial pipe, which will stop the pipeline scheduling when <code>i</code> is <code>5</code></li><li>Lines 25-32 define the second parallel pipe</li><li>Lines 34-41 define the third serial pipe</li><li>Lines 44-53 define a condition task which returns 0 when <code>N</code> is less than <code>2</code>, otherwise returns <code>1</code></li><li>Line 45 resets variable <code>i</code></li><li>Lines 56-57 define the pipeline graph using composition</li><li>Lines 58-61 define two static tasks</li><li>Line 64-66 define the task dependency</li><li>Line 69 executes the taskflow</li></ul><p>The taskflow graph of this pipeline example is illustrated as follows:</p><div class="m-graph"><svg style="width: 33.500rem; height: 25.312rem;" viewBox="0.00 0.00 536.00 404.77">
<g transform="scale(1 1) rotate(0) translate(4 400.77)">
<title>Taskflow</title>
<g id="clust1" class="cluster"><title>cluster_p0x7fff4f1276d8</title>
<polygon points="8,-8 8,-381.154 226,-381.154 226,-8 8,-8"/>
<text text-anchor="middle" x="117" y="-364.354">Taskflow</text>
</g>
<g id="clust2" class="cluster"><title>cluster_p0x7fff4f127590</title>
<polygon points="234,-204.77 234,-388.77 520,-388.77 520,-204.77 234,-204.77"/>
<text text-anchor="middle" x="377" y="-371.97">m1</text>
</g>
<g id="node1" class="node"><title>p0xdf4c58</title>
<ellipse cx="117" cy="-328.77" rx="41.9398" ry="18.2703"/>
<text text-anchor="middle" x="117" y="-324.97">initial</text>
</g>
<g id="node2" class="node"><title>p0xdf4b70</title>
<polygon points="175,-248.77 63,-248.77 59,-244.77 59,-212.77 171,-212.77 175,-216.77 175,-248.77"/>
<polyline points="171,-244.77 59,-244.77 "/>
<polyline points="171,-244.77 171,-212.77 "/>
<polyline points="171,-244.77 175,-248.77 "/>
<text text-anchor="middle" x="117" y="-226.97">pipeline [m1]</text>
</g>
<g id="edge1" class="edge"><title>p0xdf4c58&#45;&gt;p0xdf4b70</title>
<path fill="none" stroke="black" d="M117,-310.162C117,-295.864 117,-275.454 117,-259.044"/>
<polygon points="120.5,-258.943 117,-248.943 113.5,-258.943 120.5,-258.943"/>
</g>
<g id="node3" class="node"><title>p0xdf4a88</title>
<polygon points="117,-158.77 16,-132.77 117,-106.77 218,-132.77 117,-158.77"/>
<text text-anchor="middle" x="117" y="-128.97">conditional</text>
</g>
<g id="edge2" class="edge"><title>p0xdf4b70&#45;&gt;p0xdf4a88</title>
<path fill="none" stroke="black" d="M112.828,-212.425C111.67,-206.825 110.574,-200.566 110,-194.77 109.124,-185.925 109.561,-176.372 110.549,-167.509"/>
<polygon points="114.03,-167.887 111.916,-157.506 107.094,-166.94 114.03,-167.887"/>
</g>
<g id="edge3" class="edge"><title>p0xdf4a88&#45;&gt;p0xdf4b70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117,-159.091C117,-172.414 117,-188.764 117,-202.381"/>
<polygon points="113.5,-202.607 117,-212.607 120.5,-202.607 113.5,-202.607"/>
<text text-anchor="middle" x="122" y="-181.97">0</text>
</g>
<g id="node4" class="node"><title>p0xdf4d40</title>
<ellipse cx="117" cy="-34.3848" rx="56.6372" ry="18.2703"/>
<text text-anchor="middle" x="117" y="-30.5848">terminal</text>
</g>
<g id="edge4" class="edge"><title>p0xdf4a88&#45;&gt;p0xdf4d40</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117,-106.697C117,-93.4055 117,-77.0387 117,-63.3385"/>
<polygon points="120.5,-63.0325 117,-53.0326 113.5,-63.0326 120.5,-63.0325"/>
<text text-anchor="middle" x="122" y="-75.9696">1</text>
</g>
<g id="node5" class="node"><title>p0xdf4600</title>
<polygon points="367,-354.77 314,-328.77 367,-302.77 420,-328.77 367,-354.77"/>
<text text-anchor="middle" x="367" y="-324.97">cond</text>
</g>
<g id="node6" class="node"><title>p0xdf46e8</title>
<polygon points="296,-248.77 242,-248.77 242,-244.77 238,-244.77 238,-240.77 242,-240.77 242,-220.77 238,-220.77 238,-216.77 242,-216.77 242,-212.77 296,-212.77 296,-248.77"/>
<polyline points="242,-244.77 246,-244.77 246,-240.77 242,-240.77 "/>
<polyline points="242,-220.77 246,-220.77 246,-216.77 242,-216.77 "/>
<text text-anchor="middle" x="269" y="-226.97">rt&#45;0</text>
</g>
<g id="edge5" class="edge"><title>p0xdf4600&#45;&gt;p0xdf46e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349.93,-311.048C334.383,-295.818 311.24,-273.148 293.68,-255.946"/>
<polygon points="296.127,-253.444 286.535,-248.946 291.229,-258.444 296.127,-253.444"/>
<text text-anchor="middle" x="326" y="-271.97">0</text>
</g>
<g id="node7" class="node"><title>p0xdf47d0</title>
<polygon points="368,-248.77 314,-248.77 314,-244.77 310,-244.77 310,-240.77 314,-240.77 314,-220.77 310,-220.77 310,-216.77 314,-216.77 314,-212.77 368,-212.77 368,-248.77"/>
<polyline points="314,-244.77 318,-244.77 318,-240.77 314,-240.77 "/>
<polyline points="314,-220.77 318,-220.77 318,-216.77 314,-216.77 "/>
<text text-anchor="middle" x="341" y="-226.97">rt&#45;1</text>
</g>
<g id="edge6" class="edge"><title>p0xdf4600&#45;&gt;p0xdf47d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M360.97,-305.504C357.203,-291.598 352.329,-273.6 348.339,-258.867"/>
<polygon points="351.611,-257.559 345.618,-248.822 344.854,-259.389 351.611,-257.559"/>
<text text-anchor="middle" x="360" y="-271.97">1</text>
</g>
<g id="node8" class="node"><title>p0xdf48b8</title>
<polygon points="440,-248.77 386,-248.77 386,-244.77 382,-244.77 382,-240.77 386,-240.77 386,-220.77 382,-220.77 382,-216.77 386,-216.77 386,-212.77 440,-212.77 440,-248.77"/>
<polyline points="386,-244.77 390,-244.77 390,-240.77 386,-240.77 "/>
<polyline points="386,-220.77 390,-220.77 390,-216.77 386,-216.77 "/>
<text text-anchor="middle" x="413" y="-226.97">rt&#45;2</text>
</g>
<g id="edge7" class="edge"><title>p0xdf4600&#45;&gt;p0xdf48b8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M376.755,-307.41C383.657,-293.007 392.972,-273.568 400.43,-258.002"/>
<polygon points="403.631,-259.422 404.796,-248.891 397.318,-256.397 403.631,-259.422"/>
<text text-anchor="middle" x="400" y="-271.97">2</text>
</g>
<g id="node9" class="node"><title>p0xdf49a0</title>
<polygon points="512,-248.77 458,-248.77 458,-244.77 454,-244.77 454,-240.77 458,-240.77 458,-220.77 454,-220.77 454,-216.77 458,-216.77 458,-212.77 512,-212.77 512,-248.77"/>
<polyline points="458,-244.77 462,-244.77 462,-240.77 458,-240.77 "/>
<polyline points="458,-220.77 462,-220.77 462,-216.77 458,-216.77 "/>
<text text-anchor="middle" x="485" y="-226.97">rt&#45;3</text>
</g>
<g id="edge8" class="edge"><title>p0xdf4600&#45;&gt;p0xdf49a0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M386.221,-312.132C405.099,-296.773 434.148,-273.141 455.864,-255.473"/>
<polygon points="458.244,-258.049 463.792,-249.023 453.826,-252.619 458.244,-258.049"/>
<text text-anchor="middle" x="445" y="-271.97">3</text>
</g>
</g>
</svg>
</div><p>The following snippet shows one of the possible outputs:</p><pre class="m-code"><span class="n">initial</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">Rerun</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pipeline</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="n">stage</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="n">stop</span><span class="w"></span></pre><p>The pipeline runs twice as controlled by the condition task <code>conditional</code>. The starting token in the second run of the pipeline is <code>5</code> rather than <code>0</code> because the pipeline keeps a stateful number of tokens. The last token is <code>9</code>, which means the pipeline processes in total <code>10</code> scheduling tokens. The first five tokens (token <code>0</code> to <code>4</code>) are processed in the first run, and the remaining five tokens (token <code>5</code> to <code>9</code>) are processed in the second run. In the condition task, we use <code>N</code> as a decision-making counter to process the next stream of data.</p></section><section id="ConcatenateTwoPipelines"><h3><a href="#ConcatenateTwoPipelines">Example 2: Concatenate Two Pipelines</a></h3><p>This example demonstrates two concatenated pipelines where a sequence of data tokens run synchronously from one pipeline to another pipeline. The first pipeline task precedes the second pipeline task.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="c1">// define the maximum parallelism of the pipeline</span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="c1">// custom data storage</span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">;</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span>
<span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline_1 consists of three pipes (serial-parallel-serial)</span>
<span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">13</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl_1</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">14</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="p">{</span><span class="w"></span>
<span class="mi">15</span><span class="o">:</span><span class="w">     </span><span class="c1">// generate only 4 scheduling tokens</span>
<span class="mi">16</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">17</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">18</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">19</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">20</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">21</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipeline 1, pipe 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="mi">22</span><span class="o">:</span><span class="w">       </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">();</span><span class="w"></span>
<span class="mi">23</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">24</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">25</span><span class="o">:</span><span class="w"></span>
<span class="mi">26</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">27</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">28</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 1, pipe 1: input buffer_1[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">29</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">30</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">31</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">32</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">33</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">34</span><span class="o">:</span><span class="w"></span>
<span class="mi">35</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">36</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">37</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 1, pipe 2: input buffer_1[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">38</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">39</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">40</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">41</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">42</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">43</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">44</span><span class="o">:</span><span class="w">  </span>
<span class="mi">45</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline_2 consists of three pipes (serial-parallel-serial)</span>
<span class="mi">46</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">47</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl_2</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">48</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span>
<span class="mi">49</span><span class="o">:</span><span class="w">   </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="p">{</span><span class="w"></span>
<span class="mi">50</span><span class="o">:</span><span class="w">     </span><span class="c1">// generate only 4 scheduling tokens</span>
<span class="mi">51</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">52</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">53</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">54</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">55</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">56</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipeline 2, pipe 0: input value = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]);</span><span class="w"></span>
<span class="mi">57</span><span class="o">:</span><span class="w">       </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()];</span><span class="w"></span>
<span class="mi">58</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">59</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">60</span><span class="o">:</span><span class="w"></span>
<span class="mi">61</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">62</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">63</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 2, pipe 1: input buffer_2[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">64</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">65</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">66</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding 1</span>
<span class="mi">67</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">68</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">69</span><span class="o">:</span><span class="w"></span>
<span class="mi">70</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">71</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">72</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 2, pipe 2: input buffer_2[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">73</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">74</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">75</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding 1</span>
<span class="mi">76</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">77</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">78</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">79</span><span class="o">:</span><span class="w"></span>
<span class="mi">80</span><span class="o">:</span><span class="w"> </span><span class="c1">// build the pipeline graph using composition</span>
<span class="mi">81</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl_1</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline_1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">82</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl_2</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline_2&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">83</span><span class="o">:</span><span class="w"></span>
<span class="mi">84</span><span class="o">:</span><span class="w"> </span><span class="c1">// specify the graph dependency</span>
<span class="mi">85</span><span class="o">:</span><span class="w"> </span><span class="n">pipeline_1</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline_2</span><span class="p">);</span><span class="w"></span>
<span class="mi">86</span><span class="o">:</span><span class="w">  </span>
<span class="mi">87</span><span class="o">:</span><span class="w"> </span><span class="c1">// execute the taskflow</span>
<span class="mi">88</span><span class="o">:</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><p>Debrief:</p><ul><li>Line 8 defines the data storage (<code>num_lines</code> integers) for pipeline <code>pl_1</code></li><li>Line 9 defines the data storage (<code>num_lines</code> integers) for pipeline <code>pl_2</code></li><li>Lines 14-24 define the first serial pipe in <code>pl_1</code></li><li>Lines 26-33 define the second parallel pipe in <code>pl_1</code></li><li>Lines 35-42 define the third serial pipe in <code>pl_1</code></li><li>Lines 48-59 define the first serial pipe in <code>pl_2</code> that takes the results of <code>pl_1</code> as inputs</li><li>Lines 61-68 define the second parallel pipe in <code>pl_2</code></li><li>Lines 70-77 define the third serial pipe in <code>pl_2</code></li><li>Lines 81-82 define the pipeline graphs using composition</li><li>Line 85 defines the task dependency</li><li>Line 88 runs the taskflow</li></ul><p>The taskflow graph of this pipeline example is illustrated as follows:</p><div class="m-graph"><svg style="width: 47.625rem; height: 13.000rem;" viewBox="0.00 0.00 762.00 208.00">
<g transform="scale(1 1) rotate(0) translate(4 204)">
<title>Taskflow</title>
<g id="clust1" class="cluster"><title>cluster_p0x7ffeaf4d98d8</title>
<polygon points="8,-8 8,-184 158,-184 158,-8 8,-8"/>
<text text-anchor="middle" x="83" y="-167.2">Taskflow</text>
</g>
<g id="clust2" class="cluster"><title>cluster_p0x7ffeaf4d9510</title>
<polygon points="166,-8 166,-192 452,-192 452,-8 166,-8"/>
<text text-anchor="middle" x="309" y="-175.2">m2</text>
</g>
<g id="clust3" class="cluster"><title>cluster_p0x7ffeaf4d95b0</title>
<polygon points="460,-8 460,-192 746,-192 746,-8 460,-8"/>
<text text-anchor="middle" x="603" y="-175.2">m1</text>
</g>
<g id="node1" class="node"><title>p0x1da4f10</title>
<polygon points="150,-150 20,-150 16,-146 16,-114 146,-114 150,-118 150,-150"/>
<polyline points="146,-146 16,-146 "/>
<polyline points="146,-146 146,-114 "/>
<polyline points="146,-146 150,-150 "/>
<text text-anchor="middle" x="83" y="-128.2">pipeline_1 [m1]</text>
</g>
<g id="node2" class="node"><title>p0x1da4ff8</title>
<polygon points="150,-52 20,-52 16,-48 16,-16 146,-16 150,-20 150,-52"/>
<polyline points="146,-48 16,-48 "/>
<polyline points="146,-48 146,-16 "/>
<polyline points="146,-48 150,-52 "/>
<text text-anchor="middle" x="83" y="-30.2">pipeline_2 [m2]</text>
</g>
<g id="edge1" class="edge"><title>p0x1da4f10&#45;&gt;p0x1da4ff8</title>
<path fill="none" stroke="black" d="M83,-113.837C83,-99.5031 83,-78.8066 83,-62.2158"/>
<polygon points="86.5001,-62.0143 83,-52.0143 79.5001,-62.0143 86.5001,-62.0143"/>
</g>
<g id="node3" class="node"><title>p0x1da4a88</title>
<polygon points="299,-158 246,-132 299,-106 352,-132 299,-158"/>
<text text-anchor="middle" x="299" y="-128.2">cond</text>
</g>
<g id="node4" class="node"><title>p0x1da4b70</title>
<polygon points="228,-52 174,-52 174,-48 170,-48 170,-44 174,-44 174,-24 170,-24 170,-20 174,-20 174,-16 228,-16 228,-52"/>
<polyline points="174,-48 178,-48 178,-44 174,-44 "/>
<polyline points="174,-24 178,-24 178,-20 174,-20 "/>
<text text-anchor="middle" x="201" y="-30.2">rt&#45;0</text>
</g>
<g id="edge2" class="edge"><title>p0x1da4a88&#45;&gt;p0x1da4b70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M281.93,-114.278C266.383,-99.0485 243.24,-76.3781 225.68,-59.1764"/>
<polygon points="228.127,-56.6743 218.535,-52.1767 223.229,-61.6748 228.127,-56.6743"/>
<text text-anchor="middle" x="258" y="-75.2">0</text>
</g>
<g id="node5" class="node"><title>p0x1da4c58</title>
<polygon points="300,-52 246,-52 246,-48 242,-48 242,-44 246,-44 246,-24 242,-24 242,-20 246,-20 246,-16 300,-16 300,-52"/>
<polyline points="246,-48 250,-48 250,-44 246,-44 "/>
<polyline points="246,-24 250,-24 250,-20 246,-20 "/>
<text text-anchor="middle" x="273" y="-30.2">rt&#45;1</text>
</g>
<g id="edge3" class="edge"><title>p0x1da4a88&#45;&gt;p0x1da4c58</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M292.97,-108.734C289.203,-94.8282 284.329,-76.8306 280.339,-62.0978"/>
<polygon points="283.611,-60.7895 277.618,-52.0523 276.854,-62.6195 283.611,-60.7895"/>
<text text-anchor="middle" x="292" y="-75.2">1</text>
</g>
<g id="node6" class="node"><title>p0x1da4d40</title>
<polygon points="372,-52 318,-52 318,-48 314,-48 314,-44 318,-44 318,-24 314,-24 314,-20 318,-20 318,-16 372,-16 372,-52"/>
<polyline points="318,-48 322,-48 322,-44 318,-44 "/>
<polyline points="318,-24 322,-24 322,-20 318,-20 "/>
<text text-anchor="middle" x="345" y="-30.2">rt&#45;2</text>
</g>
<g id="edge4" class="edge"><title>p0x1da4a88&#45;&gt;p0x1da4d40</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308.755,-110.641C315.657,-96.2379 324.972,-76.7981 332.43,-61.2327"/>
<polygon points="335.631,-62.652 336.796,-52.1214 329.318,-59.6271 335.631,-62.652"/>
<text text-anchor="middle" x="333" y="-75.2">2</text>
</g>
<g id="node7" class="node"><title>p0x1da4e28</title>
<polygon points="444,-52 390,-52 390,-48 386,-48 386,-44 390,-44 390,-24 386,-24 386,-20 390,-20 390,-16 444,-16 444,-52"/>
<polyline points="390,-48 394,-48 394,-44 390,-44 "/>
<polyline points="390,-24 394,-24 394,-20 390,-20 "/>
<text text-anchor="middle" x="417" y="-30.2">rt&#45;3</text>
</g>
<g id="edge5" class="edge"><title>p0x1da4a88&#45;&gt;p0x1da4e28</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318.221,-115.362C337.099,-100.004 366.148,-76.3714 387.864,-58.7035"/>
<polygon points="390.244,-61.2797 395.792,-52.2538 385.826,-55.8497 390.244,-61.2797"/>
<text text-anchor="middle" x="378" y="-75.2">3</text>
</g>
<g id="node8" class="node"><title>p0x1da4600</title>
<polygon points="593,-158 540,-132 593,-106 646,-132 593,-158"/>
<text text-anchor="middle" x="593" y="-128.2">cond</text>
</g>
<g id="node9" class="node"><title>p0x1da46e8</title>
<polygon points="522,-52 468,-52 468,-48 464,-48 464,-44 468,-44 468,-24 464,-24 464,-20 468,-20 468,-16 522,-16 522,-52"/>
<polyline points="468,-48 472,-48 472,-44 468,-44 "/>
<polyline points="468,-24 472,-24 472,-20 468,-20 "/>
<text text-anchor="middle" x="495" y="-30.2">rt&#45;0</text>
</g>
<g id="edge6" class="edge"><title>p0x1da4600&#45;&gt;p0x1da46e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M575.93,-114.278C560.383,-99.0485 537.24,-76.3781 519.68,-59.1764"/>
<polygon points="522.127,-56.6743 512.535,-52.1767 517.229,-61.6748 522.127,-56.6743"/>
<text text-anchor="middle" x="552" y="-75.2">0</text>
</g>
<g id="node10" class="node"><title>p0x1da47d0</title>
<polygon points="594,-52 540,-52 540,-48 536,-48 536,-44 540,-44 540,-24 536,-24 536,-20 540,-20 540,-16 594,-16 594,-52"/>
<polyline points="540,-48 544,-48 544,-44 540,-44 "/>
<polyline points="540,-24 544,-24 544,-20 540,-20 "/>
<text text-anchor="middle" x="567" y="-30.2">rt&#45;1</text>
</g>
<g id="edge7" class="edge"><title>p0x1da4600&#45;&gt;p0x1da47d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M586.97,-108.734C583.203,-94.8282 578.329,-76.8306 574.339,-62.0978"/>
<polygon points="577.611,-60.7895 571.618,-52.0523 570.854,-62.6195 577.611,-60.7895"/>
<text text-anchor="middle" x="586" y="-75.2">1</text>
</g>
<g id="node11" class="node"><title>p0x1da48b8</title>
<polygon points="666,-52 612,-52 612,-48 608,-48 608,-44 612,-44 612,-24 608,-24 608,-20 612,-20 612,-16 666,-16 666,-52"/>
<polyline points="612,-48 616,-48 616,-44 612,-44 "/>
<polyline points="612,-24 616,-24 616,-20 612,-20 "/>
<text text-anchor="middle" x="639" y="-30.2">rt&#45;2</text>
</g>
<g id="edge8" class="edge"><title>p0x1da4600&#45;&gt;p0x1da48b8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M602.755,-110.641C609.657,-96.2379 618.972,-76.7981 626.43,-61.2327"/>
<polygon points="629.631,-62.652 630.796,-52.1214 623.318,-59.6271 629.631,-62.652"/>
<text text-anchor="middle" x="626" y="-75.2">2</text>
</g>
<g id="node12" class="node"><title>p0x1da49a0</title>
<polygon points="738,-52 684,-52 684,-48 680,-48 680,-44 684,-44 684,-24 680,-24 680,-20 684,-20 684,-16 738,-16 738,-52"/>
<polyline points="684,-48 688,-48 688,-44 684,-44 "/>
<polyline points="684,-24 688,-24 688,-20 684,-20 "/>
<text text-anchor="middle" x="711" y="-30.2">rt&#45;3</text>
</g>
<g id="edge9" class="edge"><title>p0x1da4600&#45;&gt;p0x1da49a0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M612.221,-115.362C631.099,-100.004 660.148,-76.3714 681.864,-58.7035"/>
<polygon points="684.244,-61.2797 689.792,-52.2538 679.826,-55.8497 684.244,-61.2797"/>
<text text-anchor="middle" x="671" y="-75.2">3</text>
</g>
</g>
</svg>
</div><p>The following snippet shows one of the possible outputs:</p><pre class="m-code"><span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="w"></span></pre><p>The output of pipelines <code>pl_1</code> and <code>pl_2</code> can be different from run to run because their second pipes are both parallel types. Due to the task dependency between <code>pipeline_1</code> and <code>pipeline_2</code>, the output of <code>pl_1</code> precedes the output of <code>pl_2</code>.</p></section><section id="DefineMultipleParallelPipelines"><h3><a href="#DefineMultipleParallelPipelines">Example 3: Define Multiple Parallel Pipelines</a></h3><p>This example creates two independent pipelines that run in parallel on different data sets.</p><pre class="m-code"><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">4</span><span class="o">:</span><span class="w"> </span><span class="c1">// define the maximum parallelism of the pipeline</span>
<span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">6</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="mi">7</span><span class="o">:</span><span class="w"> </span><span class="c1">// custom data storage</span>
<span class="w"> </span><span class="mi">8</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="mi">9</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">;</span><span class="w"></span>
<span class="mi">10</span><span class="o">:</span><span class="w"> </span>
<span class="mi">11</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline_1 consists of three pipes (serial-parallel-serial)</span>
<span class="mi">12</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">13</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl_1</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">14</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="p">{</span><span class="w"></span>
<span class="mi">15</span><span class="o">:</span><span class="w">     </span><span class="c1">// generate only 5 scheduling tokens</span>
<span class="mi">16</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">17</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">18</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">19</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">20</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">21</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipeline 1, pipe 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="mi">22</span><span class="o">:</span><span class="w">       </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">();</span><span class="w"></span>
<span class="mi">23</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">24</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">25</span><span class="o">:</span><span class="w"></span>
<span class="mi">26</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">27</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">28</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 1, pipe 1: input buffer_1[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">29</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">30</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">31</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">32</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">33</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">34</span><span class="o">:</span><span class="w"></span>
<span class="mi">35</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_1</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">36</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">37</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 1, pipe 2: input buffer_1[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">38</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">39</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">40</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="mi">41</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="mi">42</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">43</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">44</span><span class="o">:</span><span class="w">  </span>
<span class="mi">45</span><span class="o">:</span><span class="w"> </span><span class="c1">// the pipeline_2 consists of three pipes (serial-parallel-serial)</span>
<span class="mi">46</span><span class="o">:</span><span class="w"> </span><span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="mi">47</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="n">pl_2</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="mi">48</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="p">{</span><span class="w"></span>
<span class="mi">49</span><span class="o">:</span><span class="w">     </span><span class="c1">// generate only 2 scheduling tokens</span>
<span class="mi">50</span><span class="o">:</span><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">51</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="mi">52</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">53</span><span class="o">:</span><span class="w">     </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="mi">54</span><span class="o">:</span><span class="w">     </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">55</span><span class="o">:</span><span class="w">       </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipeline 2, pipe 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="mi">56</span><span class="o">:</span><span class="w">       </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pipeline&quot;</span><span class="p">;</span><span class="w"></span>
<span class="mi">57</span><span class="o">:</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="mi">58</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">59</span><span class="o">:</span><span class="w"></span>
<span class="mi">60</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">61</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">62</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 2, pipe 1: input buffer_2[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">63</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">64</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">65</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by concatenating &quot;_&quot;</span>
<span class="mi">66</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()];</span><span class="w"></span>
<span class="mi">67</span><span class="o">:</span><span class="w">   </span><span class="p">}},</span><span class="w"></span>
<span class="mi">68</span><span class="o">:</span><span class="w"></span>
<span class="mi">69</span><span class="o">:</span><span class="w">   </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer_2</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="mi">70</span><span class="o">:</span><span class="w">     </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="mi">71</span><span class="o">:</span><span class="w">       </span><span class="s">&quot;pipeline 2, pipe 2: input buffer_2[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="mi">72</span><span class="o">:</span><span class="w">       </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="mi">73</span><span class="o">:</span><span class="w">     </span><span class="p">);</span><span class="w"></span>
<span class="mi">74</span><span class="o">:</span><span class="w">     </span><span class="c1">// propagate the previous result to this pipe by concatenating &quot;2&quot;</span>
<span class="mi">75</span><span class="o">:</span><span class="w">     </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()];</span><span class="w"></span>
<span class="mi">76</span><span class="o">:</span><span class="w">   </span><span class="p">}}</span><span class="w"></span>
<span class="mi">77</span><span class="o">:</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="mi">78</span><span class="o">:</span><span class="w"></span>
<span class="mi">79</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl_1</span><span class="p">)</span><span class="w"></span>
<span class="mi">80</span><span class="o">:</span><span class="w">                               </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline_1&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">81</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl_2</span><span class="p">)</span><span class="w"></span>
<span class="mi">82</span><span class="o">:</span><span class="w">                               </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline_2&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">83</span><span class="o">:</span><span class="w"> </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;initial&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="mi">84</span><span class="o">:</span><span class="w">                               </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;initial&quot;</span><span class="p">);</span><span class="w"></span>
<span class="mi">85</span><span class="o">:</span><span class="w"></span>
<span class="mi">86</span><span class="o">:</span><span class="w"> </span><span class="n">initial</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline_1</span><span class="p">,</span><span class="w"> </span><span class="n">pipeline_2</span><span class="p">);</span><span class="w"></span>
<span class="mi">87</span><span class="o">:</span><span class="w">  </span>
<span class="mi">88</span><span class="o">:</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><p>Debrief:</p><ul><li>Line 8 defines the data storage (<code>num_lines</code> integers) for pipeline <code>pl_1</code></li><li>Line 9 defines the data storage (<code>num_lines</code> integers) for pipeline <code>pl_2</code></li><li>Lines 14-24 define the first serial pipe in <code>pl_1</code></li><li>Lines 26-33 define the second parallel pipe in <code>pl_1</code></li><li>Lines 35-42 define the third serial pipe in <code>pl_1</code></li><li>Lines 48-58 define the first serial pipe in <code>pl_2</code></li><li>Lines 60-67 define the second parallel pipe in <code>pl_2</code></li><li>Lines 69-76 define the third serial pipe in <code>pl_2</code></li><li>Lines 79-82 define the pipeline graphs using composition</li><li>Lines 83-84 define a static task.</li><li>Line 86 defines the task dependency</li><li>Line 88 runs the taskflow</li></ul><p>The taskflow graph of this pipeline example is illustrated as follows:</p><div class="m-graph"><svg style="width: 57.125rem; height: 13.000rem;" viewBox="0.00 0.00 914.00 208.00">
<g transform="scale(1 1) rotate(0) translate(4 204)">
<title>Taskflow</title>
<g id="clust1" class="cluster"><title>cluster_p0x7ffe35bde158</title>
<polygon points="8,-8 8,-184.385 310,-184.385 310,-8 8,-8"/>
<text text-anchor="middle" x="159" y="-167.585">Taskflow</text>
</g>
<g id="clust2" class="cluster"><title>cluster_p0x7ffe35bddd80</title>
<polygon points="318,-8 318,-192 604,-192 604,-8 318,-8"/>
<text text-anchor="middle" x="461" y="-175.2">m2</text>
</g>
<g id="clust3" class="cluster"><title>cluster_p0x7ffe35bdde20</title>
<polygon points="612,-8 612,-192 898,-192 898,-8 612,-8"/>
<text text-anchor="middle" x="755" y="-175.2">m1</text>
</g>
<g id="node1" class="node"><title>p0x131af10</title>
<polygon points="150,-52 20,-52 16,-48 16,-16 146,-16 150,-20 150,-52"/>
<polyline points="146,-48 16,-48 "/>
<polyline points="146,-48 146,-16 "/>
<polyline points="146,-48 150,-52 "/>
<text text-anchor="middle" x="83" y="-30.2">pipeline_1 [m1]</text>
</g>
<g id="node2" class="node"><title>p0x131aff8</title>
<polygon points="302,-52 172,-52 168,-48 168,-16 298,-16 302,-20 302,-52"/>
<polyline points="298,-48 168,-48 "/>
<polyline points="298,-48 298,-16 "/>
<polyline points="298,-48 302,-52 "/>
<text text-anchor="middle" x="235" y="-30.2">pipeline_2 [m2]</text>
</g>
<g id="node3" class="node"><title>p0x131b0e0</title>
<ellipse cx="159" cy="-132" rx="41.9398" ry="18.2703"/>
<text text-anchor="middle" x="159" y="-128.2">initial</text>
</g>
<g id="edge1" class="edge"><title>p0x131b0e0&#45;&gt;p0x131af10</title>
<path fill="none" stroke="black" d="M145.762,-114.278C133.92,-99.3204 116.397,-77.1854 102.873,-60.1031"/>
<polygon points="105.549,-57.8447 96.5982,-52.1767 100.061,-62.1897 105.549,-57.8447"/>
</g>
<g id="edge2" class="edge"><title>p0x131b0e0&#45;&gt;p0x131aff8</title>
<path fill="none" stroke="black" d="M172.238,-114.278C184.08,-99.3204 201.603,-77.1854 215.127,-60.1031"/>
<polygon points="217.939,-62.1897 221.402,-52.1767 212.451,-57.8447 217.939,-62.1897"/>
</g>
<g id="node4" class="node"><title>p0x131aa88</title>
<polygon points="451,-158 398,-132 451,-106 504,-132 451,-158"/>
<text text-anchor="middle" x="451" y="-128.2">cond</text>
</g>
<g id="node5" class="node"><title>p0x131ab70</title>
<polygon points="380,-52 326,-52 326,-48 322,-48 322,-44 326,-44 326,-24 322,-24 322,-20 326,-20 326,-16 380,-16 380,-52"/>
<polyline points="326,-48 330,-48 330,-44 326,-44 "/>
<polyline points="326,-24 330,-24 330,-20 326,-20 "/>
<text text-anchor="middle" x="353" y="-30.2">rt&#45;0</text>
</g>
<g id="edge3" class="edge"><title>p0x131aa88&#45;&gt;p0x131ab70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M433.93,-114.278C418.383,-99.0485 395.24,-76.3781 377.68,-59.1764"/>
<polygon points="380.127,-56.6743 370.535,-52.1767 375.229,-61.6748 380.127,-56.6743"/>
<text text-anchor="middle" x="410" y="-75.2">0</text>
</g>
<g id="node6" class="node"><title>p0x131ac58</title>
<polygon points="452,-52 398,-52 398,-48 394,-48 394,-44 398,-44 398,-24 394,-24 394,-20 398,-20 398,-16 452,-16 452,-52"/>
<polyline points="398,-48 402,-48 402,-44 398,-44 "/>
<polyline points="398,-24 402,-24 402,-20 398,-20 "/>
<text text-anchor="middle" x="425" y="-30.2">rt&#45;1</text>
</g>
<g id="edge4" class="edge"><title>p0x131aa88&#45;&gt;p0x131ac58</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444.97,-108.734C441.203,-94.8282 436.329,-76.8306 432.339,-62.0978"/>
<polygon points="435.611,-60.7895 429.618,-52.0523 428.854,-62.6195 435.611,-60.7895"/>
<text text-anchor="middle" x="444" y="-75.2">1</text>
</g>
<g id="node7" class="node"><title>p0x131ad40</title>
<polygon points="524,-52 470,-52 470,-48 466,-48 466,-44 470,-44 470,-24 466,-24 466,-20 470,-20 470,-16 524,-16 524,-52"/>
<polyline points="470,-48 474,-48 474,-44 470,-44 "/>
<polyline points="470,-24 474,-24 474,-20 470,-20 "/>
<text text-anchor="middle" x="497" y="-30.2">rt&#45;2</text>
</g>
<g id="edge5" class="edge"><title>p0x131aa88&#45;&gt;p0x131ad40</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M460.755,-110.641C467.657,-96.2379 476.972,-76.7981 484.43,-61.2327"/>
<polygon points="487.631,-62.652 488.796,-52.1214 481.318,-59.6271 487.631,-62.652"/>
<text text-anchor="middle" x="485" y="-75.2">2</text>
</g>
<g id="node8" class="node"><title>p0x131ae28</title>
<polygon points="596,-52 542,-52 542,-48 538,-48 538,-44 542,-44 542,-24 538,-24 538,-20 542,-20 542,-16 596,-16 596,-52"/>
<polyline points="542,-48 546,-48 546,-44 542,-44 "/>
<polyline points="542,-24 546,-24 546,-20 542,-20 "/>
<text text-anchor="middle" x="569" y="-30.2">rt&#45;3</text>
</g>
<g id="edge6" class="edge"><title>p0x131aa88&#45;&gt;p0x131ae28</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M470.221,-115.362C489.099,-100.004 518.148,-76.3714 539.864,-58.7035"/>
<polygon points="542.244,-61.2797 547.792,-52.2538 537.826,-55.8497 542.244,-61.2797"/>
<text text-anchor="middle" x="530" y="-75.2">3</text>
</g>
<g id="node9" class="node"><title>p0x131a600</title>
<polygon points="745,-158 692,-132 745,-106 798,-132 745,-158"/>
<text text-anchor="middle" x="745" y="-128.2">cond</text>
</g>
<g id="node10" class="node"><title>p0x131a6e8</title>
<polygon points="674,-52 620,-52 620,-48 616,-48 616,-44 620,-44 620,-24 616,-24 616,-20 620,-20 620,-16 674,-16 674,-52"/>
<polyline points="620,-48 624,-48 624,-44 620,-44 "/>
<polyline points="620,-24 624,-24 624,-20 620,-20 "/>
<text text-anchor="middle" x="647" y="-30.2">rt&#45;0</text>
</g>
<g id="edge7" class="edge"><title>p0x131a600&#45;&gt;p0x131a6e8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M727.93,-114.278C712.383,-99.0485 689.24,-76.3781 671.68,-59.1764"/>
<polygon points="674.127,-56.6743 664.535,-52.1767 669.229,-61.6748 674.127,-56.6743"/>
<text text-anchor="middle" x="704" y="-75.2">0</text>
</g>
<g id="node11" class="node"><title>p0x131a7d0</title>
<polygon points="746,-52 692,-52 692,-48 688,-48 688,-44 692,-44 692,-24 688,-24 688,-20 692,-20 692,-16 746,-16 746,-52"/>
<polyline points="692,-48 696,-48 696,-44 692,-44 "/>
<polyline points="692,-24 696,-24 696,-20 692,-20 "/>
<text text-anchor="middle" x="719" y="-30.2">rt&#45;1</text>
</g>
<g id="edge8" class="edge"><title>p0x131a600&#45;&gt;p0x131a7d0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M738.97,-108.734C735.203,-94.8282 730.329,-76.8306 726.339,-62.0978"/>
<polygon points="729.611,-60.7895 723.618,-52.0523 722.854,-62.6195 729.611,-60.7895"/>
<text text-anchor="middle" x="738" y="-75.2">1</text>
</g>
<g id="node12" class="node"><title>p0x131a8b8</title>
<polygon points="818,-52 764,-52 764,-48 760,-48 760,-44 764,-44 764,-24 760,-24 760,-20 764,-20 764,-16 818,-16 818,-52"/>
<polyline points="764,-48 768,-48 768,-44 764,-44 "/>
<polyline points="764,-24 768,-24 768,-20 764,-20 "/>
<text text-anchor="middle" x="791" y="-30.2">rt&#45;2</text>
</g>
<g id="edge9" class="edge"><title>p0x131a600&#45;&gt;p0x131a8b8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M754.755,-110.641C761.657,-96.2379 770.972,-76.7981 778.43,-61.2327"/>
<polygon points="781.631,-62.652 782.796,-52.1214 775.318,-59.6271 781.631,-62.652"/>
<text text-anchor="middle" x="778" y="-75.2">2</text>
</g>
<g id="node13" class="node"><title>p0x131a9a0</title>
<polygon points="890,-52 836,-52 836,-48 832,-48 832,-44 836,-44 836,-24 832,-24 832,-20 836,-20 836,-16 890,-16 890,-52"/>
<polyline points="836,-48 840,-48 840,-44 836,-44 "/>
<polyline points="836,-24 840,-24 840,-20 836,-20 "/>
<text text-anchor="middle" x="863" y="-30.2">rt&#45;3</text>
</g>
<g id="edge10" class="edge"><title>p0x131a600&#45;&gt;p0x131a9a0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M764.221,-115.362C783.099,-100.004 812.148,-76.3714 833.864,-58.7035"/>
<polygon points="836.244,-61.2797 841.792,-52.2538 831.826,-55.8497 836.244,-61.2797"/>
<text text-anchor="middle" x="823" y="-75.2">3</text>
</g>
</g>
</svg>
</div><p>The following snippet shows one of the possible outputs:</p><pre class="m-code"><span class="n">initial</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipeline</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span></pre><p>Because pipeline <code>pl_1</code> and pipeline <code>pl_2</code> are running in parallel, their outputs may interleave.</p></section></section><section id="ResetPipeline"><h2><a href="#ResetPipeline">Reset a Pipeline</a></h2><p>Our pipeline scheduling framework keeps a <em>stateful</em> number of scheduled tokens at each submitted run. You can reset the pipeline to the initial state using <a href="classtf_1_1Pipeline.html#a311d874b98de6f0def8a7d869e8d15bd" class="m-doc">tf::<wbr />Pipeline::<wbr />reset()</a>, where the number of scheduled tokens will start from zero in the next run. Borrowed from <a href="ParallelPipeline.html#IterateAPipeline" class="m-doc">Example 1: Iterate a Pipeline</a>, the program below resets the pipeline at the second iteration (inside the condition task) so the scheduling token will start from zero in the next run.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="nf">taskflow</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span><span class="w"></span>

<span class="c1">// define the maximum parallelism of the pipeline</span>
<span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>

<span class="c1">// custom data storage</span>
<span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">num_lines</span><span class="o">&gt;</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>

<span class="c1">// the pipeline consists of three pipes (serial-parallel-serial)</span>
<span class="c1">// and up to four concurrent scheduling tokens</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Pipeline</span><span class="w"> </span><span class="nf">pl</span><span class="p">(</span><span class="n">num_lines</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="k">mutable</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// generate only 5 scheduling tokens</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">pf</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// save the result of this pipe into the buffer</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;pipe 0: input token = %zu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">());</span><span class="w"></span>
<span class="w">      </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">token</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}},</span><span class="w"></span>

<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">PARALLEL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="w">      </span><span class="s">&quot;pipe 1: input buffer_1[%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="w">    </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}},</span><span class="w"></span>

<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Pipe</span><span class="p">{</span><span class="n">tf</span><span class="o">::</span><span class="n">PipeType</span><span class="o">::</span><span class="n">SERIAL</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="n">buffer</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Pipeflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="w"></span>
<span class="w">      </span><span class="s">&quot;pipe 2: input buffer[%zu][%zu] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">(),</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// propagate the previous result to this pipe by adding one</span>
<span class="w">    </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">pf</span><span class="p">.</span><span class="n">line</span><span class="p">()]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}}</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">conditional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="n">N</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">pl</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Rerun the pipeline</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;conditional&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">composed_of</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="w"></span>
<span class="w">                            </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;pipeline&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">initial</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;initial&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="w">                            </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;initial&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">stop</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;stop&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="w">                            </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;stop&quot;</span><span class="p">);</span><span class="w"></span>

<span class="n">initial</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline</span><span class="p">);</span><span class="w"></span>
<span class="n">pipeline</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">conditional</span><span class="p">);</span><span class="w"></span>
<span class="n">conditional</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span><span class="w"></span></pre><p>The following snippet shows one of the possible outputs:</p><pre class="m-code"><span class="n">initial</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">Rerun</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pipeline</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="n">pipe</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">buffer_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">stop</span><span class="w"></span></pre><p>The output can be different from run to run, since the second pipe is a parallel type. At the second iteration from the condition task, we reset the pipeline so the token identifier starts from <code>0</code> rather than <code>5</code>.</p></section><section id="ParallelPipelineLearnMore"><h2><a href="#ParallelPipelineLearnMore">Learn More about Taskflow Pipeline</a></h2><p>Visit the following pages to learn more about pipeline:</p><ol><li><a href="ParallelScalablePipeline.html" class="m-doc">Parallel Scalable Pipeline</a></li><li><a href="TextProcessingPipeline.html" class="m-doc">Text Processing Pipeline</a></li><li><a href="GraphProcessingPipeline.html" class="m-doc">Graph Processing Pipeline</a></li><li><a href="TaskflowProcessingPipeline.html" class="m-doc">Taskflow Processing Pipeline</a></li></ol></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2022.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.11 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
